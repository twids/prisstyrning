var re=Object.defineProperty;var se=(t,r,s)=>r in t?re(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var B=(t,r,s)=>se(t,typeof r!="symbol"?r+"":r,s);import{j as e,u as E,a as I,b as P,Q as ne,c as ae}from"./query-B6NXEsyX.js";import{c as ie,L as Z,r as b,B as oe,d as ce,e as M,a as le}from"./react-vendor-B40RXkHJ.js";import{t as de,v as p,A as ue,w as he,T as c,B as j,D as pe,S as xe,C as H,x as z,y as N,E as me,z as ge,F as ye,G as R,H as O,J as A,s as L,K as f,L as w,M as Q,O as fe,Q as je,R as ve,U as Se,V as Ce,W as we,X as be,Y as Ae,Z as ke,$,a0 as X,a1 as T,a2 as U,a3 as De,a4 as Pe,a5 as Fe,a6 as Te,a7 as He,a8 as Ee,a9 as Ie,aa as Re,ab as Oe,ac as ze}from"./mui-core-DffNbPMP.js";import{f as V}from"./date-utils-CBpsKyOP.js";import{L as Le}from"./mui-charts-ChMKhxIf.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var G={},W=ie;G.createRoot=W.createRoot,G.hydrateRoot=W.hydrateRoot;const qe=de({palette:{mode:"dark",primary:{main:"#4FC3F7"},secondary:{main:"#FFB74D"},background:{default:"#121212",paper:"#1e1e1e"},success:{main:"#8BC34A"},warning:{main:"#FFB74D"},error:{main:"#EF5350"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif'},components:{MuiButton:{styleOverrides:{root:{textTransform:"none"}}}}});function Be({children:t}){return e.jsxs(p,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[e.jsx(ue,{position:"static",children:e.jsxs(he,{children:[e.jsx(c,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Prisstyrning"}),e.jsx(j,{color:"inherit",component:Z,to:"/",startIcon:e.jsx(pe,{}),children:"Dashboard"}),e.jsx(j,{color:"inherit",component:Z,to:"/settings",startIcon:e.jsx(xe,{}),children:"Settings"})]})}),e.jsx(H,{component:"main",sx:{flex:1,py:4},children:t})]})}class Ne{constructor(){B(this,"baseUrl","")}async getAuthStatus(){return this.get("/auth/daikin/status")}async startAuth(){return this.get("/auth/daikin/start")}async refreshAuth(){return this.post("/auth/daikin/refresh")}async revokeAuth(){return this.post("/auth/daikin/revoke")}async getPriceTimeseries(r){const s=r?`?source=${r}`:"";return this.get(`/api/prices/timeseries${s}`)}async getZone(){return this.get("/api/prices/zone")}async setZone(r){return this.post("/api/prices/zone",{zone:r})}async getSchedulePreview(){return this.get("/api/schedule/preview")}async getScheduleHistory(){return this.get("/api/user/schedule-history")}async getUserSettings(){return this.get("/api/user/settings")}async saveUserSettings(r){return this.post("/api/user/settings",r)}async getDaikinSites(){return this.get("/api/daikin/sites")}async getGatewayDevices(){return this.get("/api/daikin/gateway?debug=true")}async getCurrentSchedule(r){const s=r?`?embeddedId=${r}`:"";return this.get(`/api/daikin/gateway/schedule${s}`)}async applySchedule(r){return this.post("/api/daikin/gateway/schedule/put",r)}async getStatus(){return this.get("/api/status")}async get(r){const s=await fetch(this.baseUrl+r,{credentials:"same-origin"});if(!s.ok){const a=await s.text();throw new Error(a||`HTTP ${s.status}: ${r}`)}return s.json()}async post(r,s){const a=await fetch(this.baseUrl+r,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"same-origin",body:s?JSON.stringify(s):void 0});if(!a.ok){const n=await a.text();throw new Error(n||`HTTP ${a.status}: ${r}`)}return a.json()}}const v=new Ne;function K(){const t=E(),{data:r,isLoading:s,error:a}=I({queryKey:["auth","status"],queryFn:()=>v.getAuthStatus(),refetchInterval:60*1e3,retry:1}),n=P({mutationFn:()=>v.refreshAuth(),onSuccess:()=>{t.invalidateQueries({queryKey:["auth"]})}}),i=P({mutationFn:()=>v.revokeAuth(),onSuccess:()=>{t.invalidateQueries({queryKey:["auth"]})}}),o=async()=>{const{url:l}=await v.startAuth();window.location.href=l};return{isAuthorized:(r==null?void 0:r.authorized)??!1,expiresAt:(r==null?void 0:r.expiresAtUtc)??null,isLoading:s,error:a,startAuth:o,refresh:n.mutateAsync,revoke:i.mutateAsync,isRefreshing:n.isPending,isRevoking:i.isPending}}function $e(){const{isAuthorized:t,expiresAt:r,isLoading:s}=K();if(s)return e.jsx(z,{size:24});if(!t)return e.jsx(N,{icon:e.jsx(me,{}),label:"Not Authorized",color:"error",size:"small"});const a=r?new Date(r):null,n=a?`Expires: ${V(a,"PPpp")}`:"Authorized";return e.jsx(ge,{title:n,children:e.jsx(N,{icon:e.jsx(ye,{}),label:"Authorized",color:"success",size:"small"})})}function Ge(t="latest"){return I({queryKey:["prices","timeseries",t],queryFn:()=>v.getPriceTimeseries(t),refetchInterval:5*60*1e3,staleTime:5*60*1e3})}function Ke(){const{data:t,isLoading:r,error:s}=Ge();if(r)return e.jsx(R,{children:e.jsx(O,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(z,{})})});if(s)return e.jsx(R,{children:e.jsx(O,{children:e.jsxs(A,{severity:"error",children:["Failed to load price data: ",s.message]})})});if(!t||t.items.length===0)return e.jsx(R,{children:e.jsx(O,{children:e.jsx(A,{severity:"info",children:"No price data available"})})});const a=[...t.items].sort((l,x)=>new Date(l.start).getTime()-new Date(x.start).getTime()),n=a.map(l=>new Date(l.start).getTime()),i=a.map(l=>l.day==="today"?l.value:null),o=a.map(l=>l.day==="tomorrow"?l.value:null);return e.jsx(R,{children:e.jsxs(O,{children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Electricity Prices (Ã¶re/kWh)"}),e.jsx(Le,{xAxis:[{data:n,scaleType:"time",valueFormatter:l=>new Date(l).toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"})}],series:[{label:"Today",data:i,color:"#4FC3F7",showMark:!1,curve:"monotoneX",connectNulls:!1},{label:"Tomorrow",data:o,color:"#FFB74D",showMark:!1,curve:"monotoneX",connectNulls:!1}],height:300,margin:{top:20,right:20,bottom:40,left:60}}),e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{mt:2},children:["Last updated: ",t.updated?new Date(t.updated).toLocaleString("sv-SE"):"N/A"]})]})})}const Ze=L(p)(({theme:t})=>({display:"grid",gridTemplateColumns:"auto repeat(24, 1fr)",gap:t.spacing(.25),alignItems:"center"})),Me=L(p)(({theme:t})=>({textAlign:"center",fontSize:"0.75rem",color:t.palette.text.secondary,padding:t.spacing(.5)})),_=L(p)(({theme:t})=>({fontSize:"0.875rem",fontWeight:500,padding:t.spacing(.5),textAlign:"right",paddingRight:t.spacing(1)})),J=L(p,{shouldForwardProp:t=>t!=="state"&&t!=="isCurrentHour"})(({theme:t,state:r,isCurrentHour:s})=>({height:32,border:`1px solid ${t.palette.divider}`,borderRadius:t.shape.borderRadius,position:"relative",backgroundColor:r==="comfort"?t.palette.success.main:r==="turn_off"?t.palette.error.main:t.palette.action.disabledBackground,outline:s?`2px solid ${t.palette.primary.main}`:"none",boxShadow:s?`0 0 6px ${t.palette.primary.main}`:"none",transition:"all 0.2s","&:hover":{transform:"scale(1.05)"}}));function Y({schedulePayload:t}){if(!t)return e.jsx(f,{sx:{p:2},children:e.jsx(c,{color:"text.secondary",children:"No schedule available"})});const r=new Date,s=r.getHours(),a=r.getDay(),n=Object.keys(t)[0],i=t[n],o=(i==null?void 0:i.actions)||{},l=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],x=l[a],m=l[(a+1)%7],F=o[x]||{},k=Array.from({length:24},(g,h)=>{var S;const D=`${h.toString().padStart(2,"0")}:00:00`;return(S=F[D])==null?void 0:S.domesticHotWaterTemperature}),d=o[m]||{},C=Array.from({length:24},(g,h)=>{var S;const D=`${h.toString().padStart(2,"0")}:00:00`;return(S=d[D])==null?void 0:S.domesticHotWaterTemperature});return e.jsx(f,{sx:{p:2},children:e.jsxs(Ze,{children:[e.jsx(p,{})," ",Array.from({length:24},(g,h)=>e.jsx(Me,{children:h},h)),e.jsx(_,{children:"Today"}),k.map((g,h)=>e.jsx(J,{state:g,isCurrentHour:h===s},`today-${h}`)),e.jsx(_,{children:"Tomorrow"}),C.map((g,h)=>e.jsx(J,{state:g},`tomorrow-${h}`))]})})}function Qe(){return e.jsxs(w,{direction:"row",spacing:3,sx:{mt:2},children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Q,{sx:{color:"success.main",fontSize:16}}),e.jsx(c,{variant:"body2",children:"Comfort (Heating)"})]}),e.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Q,{sx:{color:"error.main",fontSize:16}}),e.jsx(c,{variant:"body2",children:"Turn Off (No Heating)"})]})]})}function Ue(){return I({queryKey:["schedule","history"],queryFn:()=>v.getScheduleHistory(),staleTime:60*1e3})}function We(){const{data:t,isLoading:r,error:s}=Ue(),[a,n]=b.useState(!1),i=o=>(l,x)=>{n(x?o:!1)};return r?e.jsx(p,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(z,{})}):s?e.jsxs(A,{severity:"error",children:["Failed to load schedule history: ",s.message]}):!t||t.length===0?e.jsx(A,{severity:"info",children:"No schedule history found. Generate a schedule to see it here."}):e.jsx(p,{children:t.map((o,l)=>{const x=`history-${l}`,m=new Date(o.timestamp);return e.jsxs(fe,{expanded:a===x,onChange:i(x),sx:{mb:1},children:[e.jsx(je,{expandIcon:e.jsx(ve,{}),children:e.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:2,width:"100%"},children:[e.jsx(c,{children:V(m,"PPpp")}),e.jsx(N,{label:o.date,size:"small"})]})}),e.jsx(Se,{children:e.jsx(Y,{schedulePayload:o.schedule})})]},x)})})}function _e({data:t,title:r}){return e.jsxs(f,{sx:{p:2,bgcolor:"background.default"},children:[r&&e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:r}),e.jsx(p,{component:"pre",sx:{fontFamily:"monospace",fontSize:"0.875rem",overflow:"auto",maxHeight:400,margin:0},children:JSON.stringify(t,null,2)})]})}function ee({open:t,title:r,message:s,confirmText:a="Confirm",cancelText:n="Cancel",onConfirm:i,onCancel:o,isDestructive:l=!1}){return e.jsxs(Ce,{open:t,onClose:o,children:[e.jsx(we,{children:r}),e.jsx(be,{children:e.jsx(Ae,{children:s})}),e.jsxs(ke,{children:[e.jsx(j,{onClick:o,children:n}),e.jsx(j,{onClick:i,variant:"contained",color:l?"error":"primary",autoFocus:!0,children:a})]})]})}function Je(){const t=E();return P({mutationFn:()=>v.getSchedulePreview(),onSuccess:()=>{t.invalidateQueries({queryKey:["schedule","history"]})}})}function Xe(){const t=E();return P({mutationFn:r=>v.applySchedule(r),onSuccess:()=>{t.invalidateQueries({queryKey:["schedule","current"]})}})}function Ve(){return P({mutationFn:t=>v.getCurrentSchedule(t)})}function Ye(){var S;const{isAuthorized:t,startAuth:r,refresh:s,isRefreshing:a}=K(),n=Je(),[i,o]=b.useState({open:!1,message:"",severity:"info"}),[l,x]=b.useState(!1),[m,F]=b.useState({gateway:"",embedded:""}),k=Xe(),d=Ve(),C=async()=>{try{await n.mutateAsync()}catch(y){console.error("Failed to generate schedule:",y)}},g=async()=>{var y;if(!((y=n.data)!=null&&y.schedulePayload)){o({open:!0,message:"No schedule to apply. Generate a schedule first.",severity:"error"});return}x(!0)},h=async()=>{if(x(!1),!m.gateway||!m.embedded){o({open:!0,message:"Gateway Device ID and Embedded ID are required",severity:"error"});return}try{await k.mutateAsync({gatewayDeviceId:m.gateway,embeddedId:m.embedded,schedulePayload:n.data.schedulePayload}),o({open:!0,message:"Schedule applied successfully!",severity:"success"})}catch(y){o({open:!0,message:`Failed to apply schedule: ${y}`,severity:"error"})}},D=async()=>{try{await d.mutateAsync(m.embedded||void 0),o({open:!0,message:"Current schedule retrieved",severity:"success"})}catch(y){o({open:!0,message:`Failed to retrieve schedule: ${y}`,severity:"error"})}};return e.jsxs(w,{spacing:3,children:[e.jsxs(f,{sx:{p:3},children:[e.jsxs(w,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[e.jsx(c,{variant:"h5",children:"Daikin Authorization"}),e.jsx($e,{})]}),e.jsx(w,{direction:{xs:"column",sm:"row"},spacing:2,children:t?e.jsx(j,{variant:"outlined",onClick:()=>s(),disabled:a,children:a?"Refreshing...":"Refresh Token"}):e.jsx(j,{variant:"contained",onClick:r,children:"Start OAuth Flow"})})]}),e.jsx(Ke,{}),e.jsxs(f,{sx:{p:3},children:[e.jsx(c,{variant:"h5",gutterBottom:!0,children:"Schedule Preview"}),!t&&e.jsx(A,{severity:"warning",sx:{mb:2},children:"Authorize with Daikin to apply schedules to your device"}),e.jsx(j,{variant:"contained",color:"primary",onClick:C,disabled:n.isPending,sx:{mb:2},children:n.isPending?"Generating...":"Generate Schedule"}),n.isError&&e.jsxs(A,{severity:"error",sx:{mb:2},children:["Failed to generate schedule: ",n.error.message]}),n.data&&e.jsxs(p,{children:[e.jsx(Y,{schedulePayload:n.data.schedulePayload}),e.jsx(Qe,{}),n.data.message&&e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mt:2},children:n.data.message})]})]}),e.jsxs(f,{sx:{p:3},children:[e.jsx(c,{variant:"h5",gutterBottom:!0,children:"Apply Schedule to Daikin"}),e.jsxs(w,{spacing:2,children:[e.jsx($,{label:"Gateway Device ID",value:m.gateway,onChange:y=>F({...m,gateway:y.target.value}),placeholder:"Enter gateway device ID",fullWidth:!0,disabled:!t}),e.jsx($,{label:"Embedded ID",value:m.embedded,onChange:y=>F({...m,embedded:y.target.value}),placeholder:"Enter embedded ID",fullWidth:!0,disabled:!t}),e.jsxs(w,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(j,{variant:"contained",onClick:g,disabled:!t||!((S=n.data)!=null&&S.schedulePayload)||k.isPending,children:k.isPending?"Applying...":"Apply Schedule"}),e.jsx(j,{variant:"outlined",onClick:D,disabled:!t||d.isPending,children:d.isPending?"Retrieving...":"Retrieve Current Schedule"})]})]}),!!d.data&&e.jsxs(p,{sx:{mt:3},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Current Schedule"}),e.jsx(_e,{data:d.data})]})]}),e.jsxs(f,{sx:{p:3},children:[e.jsx(c,{variant:"h5",gutterBottom:!0,children:"Schedule History"}),e.jsx(We,{})]}),e.jsx(ee,{open:l,title:"Apply Schedule",message:"Are you sure you want to apply this schedule to your Daikin device? This will replace the current schedule.",confirmText:"Apply",cancelText:"Cancel",onConfirm:h,onCancel:()=>x(!1)}),e.jsx(X,{open:i.open,autoHideDuration:6e3,onClose:()=>o({...i,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(A,{onClose:()=>o({...i,open:!1}),severity:i.severity,sx:{width:"100%"},children:i.message})})]})}function et(){const t=E(),r=I({queryKey:["user","settings"],queryFn:()=>v.getUserSettings(),staleTime:60*1e3}),s=P({mutationFn:a=>v.saveUserSettings(a),onSuccess:()=>{t.invalidateQueries({queryKey:["user","settings"]}),t.invalidateQueries({queryKey:["schedule","preview"]})}});return{settings:r.data,isLoading:r.isLoading,error:r.error,updateSettings:s.mutateAsync,isUpdating:s.isPending}}function tt(){const t=E(),r=I({queryKey:["user","zone"],queryFn:async()=>(await v.getZone()).zone,staleTime:5*60*1e3}),s=P({mutationFn:a=>v.setZone(a),onSuccess:()=>{t.invalidateQueries({queryKey:["user","zone"]}),t.invalidateQueries({queryKey:["prices","timeseries"]}),t.invalidateQueries({queryKey:["schedule","preview"]})}});return{zone:r.data,isLoading:r.isLoading,error:r.error,setZone:s.mutateAsync,isUpdating:s.isPending}}function rt(){return e.jsxs(w,{spacing:3,children:[e.jsxs(f,{sx:{p:3},children:[e.jsx(T,{variant:"text",width:"40%",height:40}),e.jsx(T,{variant:"rectangular",height:200,sx:{mt:2}})]}),e.jsxs(f,{sx:{p:3},children:[e.jsx(T,{variant:"text",width:"30%",height:40}),e.jsx(T,{variant:"rectangular",height:150,sx:{mt:2}})]}),e.jsxs(f,{sx:{p:3},children:[e.jsx(T,{variant:"text",width:"50%",height:40}),e.jsx(T,{variant:"rectangular",height:100,sx:{mt:2}})]})]})}const st=["SE1","SE2","SE3","SE4","NO1","NO2","NO3","NO4","NO5","DK1","DK2","FI"];function nt(){const{settings:t,isLoading:r,error:s,updateSettings:a,isUpdating:n}=et(),{zone:i,setZone:o,isUpdating:l}=tt(),{isAuthorized:x,refresh:m,revoke:F,isRefreshing:k}=K(),[d,C]=b.useState({comfortHours:3,turnOffPercentile:.9,maxComfortGapHours:1,autoApplySchedule:!1,selectedZone:"SE3"}),[g,h]=b.useState({open:!1,message:"",severity:"success"}),[D,S]=b.useState(!1);b.useEffect(()=>{t&&C(u=>({...u,comfortHours:t.ComfortHours??3,turnOffPercentile:t.TurnOffPercentile??.9,maxComfortGapHours:t.MaxComfortGapHours??1,autoApplySchedule:t.AutoApplySchedule??!1}))},[t]),b.useEffect(()=>{i&&C(u=>({...u,selectedZone:i}))},[i]);const y=async()=>{try{await a({ComfortHours:d.comfortHours,TurnOffPercentile:d.turnOffPercentile,MaxComfortGapHours:d.maxComfortGapHours,AutoApplySchedule:d.autoApplySchedule}),d.selectedZone!==i&&await o(d.selectedZone),h({open:!0,message:"Settings saved successfully",severity:"success"})}catch(u){h({open:!0,message:`Failed to save settings: ${u}`,severity:"error"})}},te=async()=>{S(!1);try{await F(),h({open:!0,message:"Daikin authentication revoked",severity:"info"})}catch(u){h({open:!0,message:`Failed to revoke: ${u}`,severity:"error"})}};return r?e.jsx(H,{maxWidth:"md",sx:{py:4},children:e.jsx(rt,{})}):s?e.jsx(H,{maxWidth:"md",sx:{py:4},children:e.jsxs(A,{severity:"error",children:["Failed to load settings: ",s.message]})}):e.jsxs(H,{maxWidth:"md",sx:{py:4},children:[e.jsx(c,{variant:"h4",gutterBottom:!0,sx:{fontSize:{xs:"1.5rem",md:"2rem"}},children:"Settings"}),e.jsxs(w,{spacing:3,children:[e.jsxs(f,{sx:{p:3},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Schedule Configuration"}),e.jsxs(w,{spacing:3,children:[e.jsxs(p,{children:[e.jsxs(c,{gutterBottom:!0,children:["Comfort Hours: ",d.comfortHours]}),e.jsx(U,{value:d.comfortHours,onChange:(u,q)=>C({...d,comfortHours:q}),min:1,max:10,step:1,marks:!0,valueLabelDisplay:"auto"}),e.jsx(c,{variant:"caption",color:"text.secondary",children:"Number of hours per day to heat water to comfort temperature"})]}),e.jsxs(p,{children:[e.jsxs(c,{gutterBottom:!0,children:["Turn Off Percentile: ",(d.turnOffPercentile*100).toFixed(0),"%"]}),e.jsx(U,{value:d.turnOffPercentile,onChange:(u,q)=>C({...d,turnOffPercentile:q}),min:.5,max:1,step:.05,marks:[{value:.5,label:"50%"},{value:.75,label:"75%"},{value:1,label:"100%"}],valueLabelDisplay:"auto",valueLabelFormat:u=>`${(u*100).toFixed(0)}%`}),e.jsx(c,{variant:"caption",color:"text.secondary",children:"Price threshold for turning off DHW heating (higher = less turn-off)"})]}),e.jsx($,{label:"Max Comfort Gap (hours)",type:"number",value:d.maxComfortGapHours,onChange:u=>C({...d,maxComfortGapHours:parseInt(u.target.value)||1}),inputProps:{min:0,max:5,step:1},helperText:"Maximum gap between consecutive comfort hours (0 = disabled)"}),e.jsxs(De,{fullWidth:!0,children:[e.jsx(Pe,{children:"Nordpool Zone"}),e.jsx(Fe,{value:d.selectedZone,onChange:u=>C({...d,selectedZone:u.target.value}),label:"Nordpool Zone",children:st.map(u=>e.jsx(Te,{value:u,children:u},u))})]})]})]}),e.jsxs(f,{sx:{p:3},children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Automation"}),e.jsx(He,{control:e.jsx(Ee,{checked:d.autoApplySchedule,onChange:u=>C({...d,autoApplySchedule:u.target.checked})}),label:"Auto-apply schedule daily"}),e.jsx(c,{variant:"caption",color:"text.secondary",display:"block",children:"Automatically apply generated schedule to your Daikin device each day"})]}),e.jsx(j,{variant:"contained",size:"large",onClick:y,disabled:n||l,children:n||l?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:20,sx:{mr:1}}),"Saving..."]}):"Save Settings"}),e.jsx(Ie,{}),e.jsxs(f,{sx:{p:3,border:"1px solid",borderColor:"error.main"},children:[e.jsx(c,{variant:"h6",color:"error",gutterBottom:!0,children:"Danger Zone"}),e.jsxs(w,{spacing:2,children:[e.jsxs(p,{children:[e.jsx(c,{variant:"body2",gutterBottom:!0,children:"Revoke Daikin authentication to disconnect your account."}),e.jsx(j,{variant:"outlined",color:"error",onClick:()=>S(!0),disabled:!x,children:"Revoke Daikin Access"})]}),e.jsxs(p,{children:[e.jsx(c,{variant:"body2",gutterBottom:!0,children:"Refresh authentication token (use if experiencing connectivity issues)."}),e.jsx(j,{variant:"outlined",onClick:()=>m(),disabled:!x||k,children:k?"Refreshing...":"Refresh Token"})]})]})]})]}),e.jsx(ee,{open:D,title:"Revoke Daikin Access",message:"Are you sure you want to revoke access to your Daikin account? You will need to re-authorize to use schedule application features.",confirmText:"Revoke",cancelText:"Cancel",onConfirm:te,onCancel:()=>S(!1),isDestructive:!0}),e.jsx(X,{open:g.open,autoHideDuration:6e3,onClose:()=>h({...g,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(A,{onClose:()=>h({...g,open:!1}),severity:g.severity,children:g.message})})]})}class at extends b.Component{constructor(s){super(s);B(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0}),window.location.href="/"});this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,a){console.error("ErrorBoundary caught error:",s,a)}render(){var s;return this.state.hasError?e.jsx(H,{maxWidth:"sm",sx:{py:8},children:e.jsx(f,{sx:{p:4,textAlign:"center"},children:e.jsxs(w,{spacing:3,alignItems:"center",children:[e.jsx(Re,{color:"error",sx:{fontSize:64}}),e.jsx(c,{variant:"h4",children:"Something went wrong"}),e.jsx(c,{variant:"body1",color:"text.secondary",children:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred"}),e.jsx(j,{variant:"contained",onClick:this.handleReset,children:"Return to Dashboard"})]})})}):this.props.children}}const it=new ne({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function ot(){return e.jsx(at,{children:e.jsx(ae,{client:it,children:e.jsxs(Oe,{theme:qe,children:[e.jsx(ze,{}),e.jsx(oe,{children:e.jsx(Be,{children:e.jsxs(ce,{children:[e.jsx(M,{path:"/",element:e.jsx(Ye,{})}),e.jsx(M,{path:"/settings",element:e.jsx(nt,{})})]})})},"router")]})})})}G.createRoot(document.getElementById("root")).render(e.jsx(le.StrictMode,{children:e.jsx(ot,{})}));
//# sourceMappingURL=index-CNnhjDRn.js.map

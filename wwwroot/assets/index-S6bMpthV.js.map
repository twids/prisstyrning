{"version":3,"file":"index-S6bMpthV.js","sources":["../../frontend/node_modules/react-dom/client.js","../../frontend/src/theme.ts","../../frontend/src/api/client.ts","../../frontend/src/components/Layout.tsx","../../frontend/src/hooks/useAuth.ts","../../frontend/src/components/AuthStatusChip.tsx","../../frontend/src/hooks/usePrices.ts","../../frontend/src/components/PriceChart.tsx","../../frontend/src/components/ScheduleGrid.tsx","../../frontend/src/components/ScheduleLegend.tsx","../../frontend/src/hooks/useScheduleHistory.ts","../../frontend/src/components/ScheduleHistoryList.tsx","../../frontend/src/components/JsonViewer.tsx","../../frontend/src/components/ConfirmDialog.tsx","../../frontend/src/hooks/useSchedulePreview.ts","../../frontend/src/hooks/useApplySchedule.ts","../../frontend/src/hooks/useCurrentSchedule.ts","../../frontend/src/hooks/useFlexibleState.ts","../../frontend/src/hooks/useUserSettings.ts","../../frontend/src/hooks/useManualComfort.ts","../../frontend/src/pages/DashboardPage.tsx","../../frontend/src/hooks/useZone.ts","../../frontend/src/components/LoadingSkeleton.tsx","../../frontend/src/pages/SettingsPage.tsx","../../frontend/src/pages/AdminPage.tsx","../../frontend/src/components/ErrorBoundary.tsx","../../frontend/src/App.tsx","../../frontend/src/main.tsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import { createTheme } from '@mui/material/styles';\r\n\r\nexport const theme = createTheme({\r\n  palette: {\r\n    mode: 'dark', // Match current UI\r\n    primary: {\r\n      main: '#4FC3F7', // Light blue (current chart color)\r\n    },\r\n    secondary: {\r\n      main: '#FFB74D', // Orange (current chart color)\r\n    },\r\n    background: {\r\n      default: '#121212',\r\n      paper: '#1e1e1e',\r\n    },\r\n    success: {\r\n      main: '#8BC34A', // Green for comfort mode\r\n    },\r\n    warning: {\r\n      main: '#FFB74D', // Orange for eco mode (legacy)\r\n    },\r\n    error: {\r\n      main: '#EF5350', // Red for turn_off mode\r\n    },\r\n  },\r\n  typography: {\r\n    fontFamily: '\"Roboto\", \"Helvetica\", \"Arial\", sans-serif',\r\n  },\r\n  components: {\r\n    MuiButton: {\r\n      styleOverrides: {\r\n        root: {\r\n          textTransform: 'none', // No ALL CAPS\r\n        },\r\n      },\r\n    },\r\n  },\r\n});\r\n","import type * as T from '../types/api';\r\n\r\nclass ApiClient {\r\n  private baseUrl = ''; // Empty for same-origin requests (Vite proxy handles routing)\r\n\r\n  // Auth endpoints\r\n  async getAuthStatus(): Promise<T.DaikinAuthStatus> {\r\n    return this.get('/auth/daikin/status');\r\n  }\r\n\r\n  async startAuth(): Promise<T.AuthUrlResponse> {\r\n    return this.get('/auth/daikin/start');\r\n  }\r\n\r\n  async refreshAuth(): Promise<T.AuthRefreshResponse> {\r\n    return this.post('/auth/daikin/refresh');\r\n  }\r\n\r\n  async revokeAuth(): Promise<T.AuthRevokeResponse> {\r\n    return this.post('/auth/daikin/revoke');\r\n  }\r\n\r\n  // Price endpoints\r\n  async getPriceTimeseries(source?: 'latest' | 'memory'): Promise<T.PriceTimeseries> {\r\n    const params = source ? `?source=${source}` : '';\r\n    return this.get(`/api/prices/timeseries${params}`);\r\n  }\r\n\r\n  async getZone(): Promise<T.ZoneResponse> {\r\n    return this.get('/api/prices/zone');\r\n  }\r\n\r\n  async setZone(zone: string): Promise<T.SaveZoneResponse> {\r\n    return this.post('/api/prices/zone', { zone });\r\n  }\r\n\r\n  // Schedule endpoints\r\n  async getSchedulePreview(): Promise<T.SchedulePreviewResponse> {\r\n    return this.get('/api/schedule/preview');\r\n  }\r\n\r\n  async getScheduleHistory(): Promise<T.ScheduleHistoryEntry[]> {\r\n    return this.get('/api/user/schedule-history');\r\n  }\r\n\r\n  // User Settings\r\n  async getUserSettings(): Promise<T.UserSettings> {\r\n    return this.get('/api/user/settings');\r\n  }\r\n\r\n  async saveUserSettings(settings: Partial<T.UserSettings>): Promise<T.SaveSettingsResponse> {\r\n    return this.post('/api/user/settings', settings);\r\n  }\r\n\r\n  // Daikin endpoints\r\n  async getDaikinSites(): Promise<unknown> {\r\n    return this.get('/api/daikin/sites');\r\n  }\r\n\r\n  async getGatewayDevices(): Promise<unknown> {\r\n    return this.get('/api/daikin/gateway?debug=true');\r\n  }\r\n\r\n  async getCurrentSchedule(embeddedId?: string): Promise<unknown> {\r\n    const params = embeddedId ? `?embeddedId=${embeddedId}` : '';\r\n    return this.get(`/api/daikin/gateway/schedule${params}`);\r\n  }\r\n\r\n  async applySchedule(payload: T.ApplyScheduleRequest): Promise<T.ApplyScheduleResponse> {\r\n    return this.post('/api/daikin/gateway/schedule/put', payload);\r\n  }\r\n\r\n  // Flexible scheduling state\r\n  async getFlexibleState(): Promise<T.FlexibleState> {\r\n    return this.get('/api/user/flexible-state');\r\n  }\r\n\r\n  // Manual comfort\r\n  async scheduleManualComfort(comfortTime: string): Promise<{ applied: boolean; comfortHour: string; message: string }> {\r\n    return this.post('/api/schedule/comfort', { comfortTime });\r\n  }\r\n\r\n  // Status\r\n  async getStatus(): Promise<T.StatusResponse> {\r\n    return this.get('/api/status');\r\n  }\r\n\r\n  // Admin endpoints\r\n  async getAdminStatus(): Promise<T.AdminStatus> {\r\n    return this.get('/api/admin/status');\r\n  }\r\n\r\n  // Uses custom fetch instead of post() helper since we need X-Admin-Password header without JSON body\r\n  async adminLogin(password: string): Promise<{ granted: boolean; userId: string }> {\r\n    const response = await fetch(this.baseUrl + '/api/admin/login', {\r\n      method: 'POST',\r\n      headers: { 'X-Admin-Password': password },\r\n      credentials: 'same-origin',\r\n    });\r\n    if (!response.ok) {\r\n      const text = await response.text();\r\n      throw new Error(this.extractErrorMessage(text) || `HTTP ${response.status}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  async getAdminUsers(): Promise<T.AdminUsersResponse> {\r\n    return this.get('/api/admin/users');\r\n  }\r\n\r\n  async grantAdmin(userId: string): Promise<{ granted: boolean; userId: string }> {\r\n    return this.post(`/api/admin/users/${encodeURIComponent(userId)}/grant`);\r\n  }\r\n\r\n  async revokeAdmin(userId: string): Promise<{ revoked: boolean; userId: string }> {\r\n    return this.del(`/api/admin/users/${encodeURIComponent(userId)}/grant`);\r\n  }\r\n\r\n  async grantHangfire(userId: string): Promise<{ granted: boolean; userId: string }> {\r\n    return this.post(`/api/admin/users/${encodeURIComponent(userId)}/hangfire`);\r\n  }\r\n\r\n  async revokeHangfire(userId: string): Promise<{ revoked: boolean; userId: string }> {\r\n    return this.del(`/api/admin/users/${encodeURIComponent(userId)}/hangfire`);\r\n  }\r\n\r\n  async deleteUser(userId: string): Promise<{ deleted: boolean; userId: string }> {\r\n    return this.del(`/api/admin/users/${encodeURIComponent(userId)}`);\r\n  }\r\n\r\n  // Helper methods\r\n  private async get<T>(url: string): Promise<T> {\r\n    const response = await fetch(this.baseUrl + url, {\r\n      credentials: 'same-origin', // Include cookies for ps_user\r\n    });\r\n    if (!response.ok) {\r\n      const text = await response.text();\r\n      throw new Error(this.extractErrorMessage(text) || `HTTP ${response.status}: ${url}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  private async post<T>(url: string, body?: unknown): Promise<T> {\r\n    const response = await fetch(this.baseUrl + url, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'same-origin', // Include cookies\r\n      body: body ? JSON.stringify(body) : undefined,\r\n    });\r\n    if (!response.ok) {\r\n      const text = await response.text();\r\n      throw new Error(this.extractErrorMessage(text) || `HTTP ${response.status}: ${url}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  private async del<T>(url: string): Promise<T> {\r\n    const response = await fetch(this.baseUrl + url, {\r\n      method: 'DELETE',\r\n      credentials: 'same-origin',\r\n    });\r\n    if (!response.ok) {\r\n      const text = await response.text();\r\n      throw new Error(this.extractErrorMessage(text) || `HTTP ${response.status}: ${url}`);\r\n    }\r\n    return response.json();\r\n  }\r\n\r\n  /** Try to extract a user-friendly error message from a response body that may be JSON */\r\n  private extractErrorMessage(text: string): string {\r\n    if (!text) return '';\r\n    try {\r\n      const json = JSON.parse(text);\r\n      if (typeof json.error === 'string') return json.error;\r\n    } catch {\r\n      // Not JSON, return as-is\r\n    }\r\n    return text;\r\n  }\r\n}\r\n\r\nexport const apiClient = new ApiClient();\r\n","import { ReactNode } from 'react';\r\nimport { AppBar, Toolbar, Typography, Container, Button, Box } from '@mui/material';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport SettingsIcon from '@mui/icons-material/Settings';\r\nimport DashboardIcon from '@mui/icons-material/Dashboard';\r\nimport AdminPanelSettingsIcon from '@mui/icons-material/AdminPanelSettings';\r\nimport { apiClient } from '../api/client';\r\n\r\ninterface LayoutProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport default function Layout({ children }: LayoutProps) {\r\n  const adminStatusQuery = useQuery({\r\n    queryKey: ['admin-status'],\r\n    queryFn: () => apiClient.getAdminStatus(),\r\n    staleTime: 5 * 60 * 1000, // Cache for 5 minutes to avoid excessive requests\r\n  });\r\n\r\n  const isAdmin = adminStatusQuery.data?.isAdmin ?? false;\r\n\r\n  return (\r\n    <Box sx={{ display: 'flex', flexDirection: 'column', minHeight: '100vh' }}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>\r\n            Prisstyrning\r\n          </Typography>\r\n          <Button\r\n            color=\"inherit\"\r\n            component={RouterLink}\r\n            to=\"/\"\r\n            startIcon={<DashboardIcon />}\r\n          >\r\n            Dashboard\r\n          </Button>\r\n          <Button\r\n            color=\"inherit\"\r\n            component={RouterLink}\r\n            to=\"/settings\"\r\n            startIcon={<SettingsIcon />}\r\n          >\r\n            Settings\r\n          </Button>\r\n          {isAdmin && (\r\n            <Button\r\n              color=\"inherit\"\r\n              component={RouterLink}\r\n              to=\"/admin\"\r\n              startIcon={<AdminPanelSettingsIcon />}\r\n            >\r\n              Admin\r\n            </Button>\r\n          )}\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Container component=\"main\" sx={{ flex: 1, py: 4 }}>\r\n        {children}\r\n      </Container>\r\n    </Box>\r\n  );\r\n}\r\n","import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\n\r\nexport function useAuth() {\r\n  const queryClient = useQueryClient();\r\n\r\n  // Query auth status every minute\r\n  const { data, isLoading, error } = useQuery({\r\n    queryKey: ['auth', 'status'],\r\n    queryFn: () => apiClient.getAuthStatus(),\r\n    refetchInterval: 60 * 1000, // 1 minute\r\n    retry: 1,\r\n  });\r\n\r\n  // Mutation for manual refresh\r\n  const refreshMutation = useMutation({\r\n    mutationFn: () => apiClient.refreshAuth(),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['auth'] });\r\n    },\r\n  });\r\n\r\n  // Mutation for token revocation\r\n  const revokeMutation = useMutation({\r\n    mutationFn: () => apiClient.revokeAuth(),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['auth'] });\r\n    },\r\n  });\r\n\r\n  // Function to start OAuth flow\r\n  const startAuth = async () => {\r\n    const { url } = await apiClient.startAuth();\r\n    window.location.href = url; // Redirect to Daikin OAuth\r\n  };\r\n\r\n  return {\r\n    isAuthorized: data?.authorized ?? false,\r\n    expiresAt: data?.expiresAtUtc ?? null,\r\n    isLoading,\r\n    error,\r\n    startAuth,\r\n    refresh: refreshMutation.mutateAsync,\r\n    revoke: revokeMutation.mutateAsync,\r\n    isRefreshing: refreshMutation.isPending,\r\n    isRevoking: revokeMutation.isPending,\r\n  };\r\n}\r\n","import { Chip, CircularProgress, Tooltip } from '@mui/material';\r\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\r\nimport ErrorIcon from '@mui/icons-material/Error';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { format } from 'date-fns';\r\n\r\nexport default function AuthStatusChip() {\r\n  const { isAuthorized, expiresAt, isLoading } = useAuth();\r\n\r\n  if (isLoading) {\r\n    return <CircularProgress size={24} />;\r\n  }\r\n\r\n  if (!isAuthorized) {\r\n    return (\r\n      <Chip\r\n        icon={<ErrorIcon />}\r\n        label=\"Not Authorized\"\r\n        color=\"error\"\r\n        size=\"small\"\r\n      />\r\n    );\r\n  }\r\n\r\n  const expiresAtDate = expiresAt ? new Date(expiresAt) : null;\r\n  const tooltipText = expiresAtDate\r\n    ? `Expires: ${format(expiresAtDate, 'PPpp')}`\r\n    : 'Authorized';\r\n\r\n  return (\r\n    <Tooltip title={tooltipText}>\r\n      <Chip\r\n        icon={<CheckCircleIcon />}\r\n        label=\"Authorized\"\r\n        color=\"success\"\r\n        size=\"small\"\r\n      />\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useQuery } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\n\r\nexport function usePrices(source: 'latest' | 'memory' = 'latest') {\r\n  return useQuery({\r\n    queryKey: ['prices', 'timeseries', source],\r\n    queryFn: () => apiClient.getPriceTimeseries(source),\r\n    refetchInterval: 5 * 60 * 1000, // 5 minutes\r\n    staleTime: 5 * 60 * 1000,\r\n  });\r\n}\r\n","import { LineChart } from '@mui/x-charts/LineChart';\r\nimport { Card, CardContent, Typography, CircularProgress, Alert } from '@mui/material';\r\nimport { usePrices } from '../hooks/usePrices';\r\n\r\nexport default function PriceChart() {\r\n  const { data, isLoading, error } = usePrices();\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardContent sx={{ display: 'flex', justifyContent: 'center', p: 4 }}>\r\n          <CircularProgress />\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Card>\r\n        <CardContent>\r\n          <Alert severity=\"error\">\r\n            Failed to load price data: {error.message}\r\n          </Alert>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (!data || data.items.length === 0) {\r\n    return (\r\n      <Card>\r\n        <CardContent>\r\n          <Alert severity=\"info\">No price data available</Alert>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // Sort all items chronologically to form the X-axis\r\n  const allItems = [...data.items].sort((a, b) => \r\n    new Date(a.start).getTime() - new Date(b.start).getTime()\r\n  );\r\n  \r\n  const xAxisData = allItems.map(p => new Date(p.start).getTime());\r\n  \r\n  // Create series data matching the X-axis length\r\n  // Use null for points that don't belong to the series\r\n  const todayData = allItems.map((p) => \r\n    p.day === 'today' ? p.value : null\r\n  );\r\n\r\n  const tomorrowData = allItems.map((p) => \r\n    p.day === 'tomorrow' ? p.value : null\r\n  );\r\n\r\n  return (\r\n    <Card>\r\n      <CardContent>\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          Electricity Prices (öre/kWh)\r\n        </Typography>\r\n        <LineChart\r\n          xAxis={[\r\n            {\r\n              data: xAxisData,\r\n              scaleType: 'time',\r\n              valueFormatter: (value: number) =>\r\n                new Date(value).toLocaleTimeString('sv-SE', {\r\n                  hour: '2-digit',\r\n                  minute: '2-digit',\r\n                }),\r\n            },\r\n          ]}\r\n          series={[\r\n            {\r\n              label: 'Today',\r\n              data: todayData,\r\n              color: '#4FC3F7', // Primary color\r\n              showMark: false,\r\n              curve: 'monotoneX',\r\n              connectNulls: false,\r\n            },\r\n            {\r\n              label: 'Tomorrow',\r\n              data: tomorrowData,\r\n              color: '#FFB74D', // Secondary color\r\n              showMark: false,\r\n              curve: 'monotoneX',\r\n              connectNulls: false,\r\n            },\r\n          ]}\r\n          height={300}\r\n          margin={{ top: 20, right: 20, bottom: 40, left: 60 }}\r\n        />\r\n        <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 2 }}>\r\n          Last updated: {data.updated ? new Date(data.updated).toLocaleString('sv-SE') : 'N/A'}\r\n        </Typography>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n","import { Box, Paper, Typography, styled } from '@mui/material';\r\nimport type { SchedulePayload, ScheduleState } from '../types/api';\r\n\r\nconst GridContainer = styled(Box)(({ theme }) => ({\r\n  display: 'grid',\r\n  gridTemplateColumns: 'auto repeat(24, 1fr)',\r\n  gap: theme.spacing(0.25),\r\n  alignItems: 'center',\r\n}));\r\n\r\nconst HourHeader = styled(Box)(({ theme }) => ({\r\n  textAlign: 'center',\r\n  fontSize: '0.75rem',\r\n  color: theme.palette.text.secondary,\r\n  padding: theme.spacing(0.5),\r\n}));\r\n\r\nconst DayLabel = styled(Box)(({ theme }) => ({\r\n  fontSize: '0.875rem',\r\n  fontWeight: 500,\r\n  padding: theme.spacing(0.5),\r\n  textAlign: 'right',\r\n  paddingRight: theme.spacing(1),\r\n}));\r\n\r\ninterface CellProps {\r\n  state?: ScheduleState;\r\n  isCurrentHour?: boolean;\r\n}\r\n\r\nconst Cell = styled(Box, {\r\n  shouldForwardProp: (prop) => prop !== 'state' && prop !== 'isCurrentHour',\r\n})<CellProps>(({ theme, state, isCurrentHour }) => ({\r\n  height: 32,\r\n  border: `1px solid ${theme.palette.divider}`,\r\n  borderRadius: theme.shape.borderRadius,\r\n  position: 'relative',\r\n  backgroundColor:\r\n    state === 'comfort'\r\n      ? theme.palette.success.main\r\n      : state === 'eco'\r\n      ? theme.palette.info.main\r\n      : state === 'turn_off'\r\n      ? theme.palette.error.main\r\n      : theme.palette.action.disabledBackground,\r\n  outline: isCurrentHour ? `2px solid ${theme.palette.primary.main}` : 'none',\r\n  boxShadow: isCurrentHour ? `0 0 6px ${theme.palette.primary.main}` : 'none',\r\n  transition: 'all 0.2s',\r\n  '&:hover': {\r\n    transform: 'scale(1.05)',\r\n  },\r\n}));\r\n\r\ninterface ScheduleGridProps {\r\n  schedulePayload: SchedulePayload | null;\r\n}\r\n\r\nexport default function ScheduleGrid({ schedulePayload }: ScheduleGridProps) {\r\n  if (!schedulePayload) {\r\n    return (\r\n      <Paper sx={{ p: 2 }}>\r\n        <Typography color=\"text.secondary\">No schedule available</Typography>\r\n      </Paper>\r\n    );\r\n  }\r\n\r\n  // Parse schedule payload (complex logic - see current ui.js for reference)\r\n  // Extract 24x2 grid of states for today and tomorrow\r\n  \r\n  // Get current hour for highlighting\r\n  const now = new Date();\r\n  const currentHour = now.getHours();\r\n  const currentDay = now.getDay(); // 0 = Sunday, 6 = Saturday\r\n\r\n  // Simplified parsing (TODO: Handle all schedule formats)\r\n  const scheduleId = Object.keys(schedulePayload)[0];\r\n  const schedule = schedulePayload[scheduleId];\r\n  const actions = schedule?.actions || {};\r\n\r\n  // Map day names\r\n  const dayNames = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];\r\n  const todayName = dayNames[currentDay];\r\n  const tomorrowName = dayNames[(currentDay + 1) % 7];\r\n\r\n  // Extract today's states\r\n  const todayActions = actions[todayName] || {};\r\n  const todayStates: Array<ScheduleState | undefined> = Array.from({ length: 24 }, (_, hour) => {\r\n    const timeKey = `${hour.toString().padStart(2, '0')}:00:00`;\r\n    return todayActions[timeKey]?.domesticHotWaterTemperature as ScheduleState | undefined;\r\n  });\r\n\r\n  // Extract tomorrow's states\r\n  const tomorrowActions = actions[tomorrowName] || {};\r\n  const tomorrowStates: Array<ScheduleState | undefined> = Array.from({ length: 24 }, (_, hour) => {\r\n    const timeKey = `${hour.toString().padStart(2, '0')}:00:00`;\r\n    return tomorrowActions[timeKey]?.domesticHotWaterTemperature as ScheduleState | undefined;\r\n  });\r\n\r\n  return (\r\n    <Paper sx={{ p: 2 }}>\r\n      <GridContainer>\r\n        {/* Header row */}\r\n        <Box /> {/* Empty corner */}\r\n        {Array.from({ length: 24 }, (_, i) => (\r\n          <HourHeader key={i}>{i}</HourHeader>\r\n        ))}\r\n\r\n        {/* Today row */}\r\n        <DayLabel>Today</DayLabel>\r\n        {todayStates.map((state, hour) => (\r\n          <Cell key={`today-${hour}`} state={state} isCurrentHour={hour === currentHour} />\r\n        ))}\r\n\r\n        {/* Tomorrow row */}\r\n        <DayLabel>Tomorrow</DayLabel>\r\n        {tomorrowStates.map((state, hour) => (\r\n          <Cell key={`tomorrow-${hour}`} state={state} />\r\n        ))}\r\n      </GridContainer>\r\n    </Paper>\r\n  );\r\n}\r\n","import { Box, Typography, Stack } from '@mui/material';\r\nimport CircleIcon from '@mui/icons-material/Circle';\r\n\r\nexport default function ScheduleLegend() {\r\n  return (\r\n    <Stack direction=\"row\" spacing={3} sx={{ mt: 2 }}>\r\n      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n        <CircleIcon sx={{ color: 'success.main', fontSize: 16 }} />\r\n        <Typography variant=\"body2\">Comfort (Heating)</Typography>\r\n      </Box>\r\n      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n        <CircleIcon sx={{ color: 'info.main', fontSize: 16 }} />\r\n        <Typography variant=\"body2\">Eco (Daily DHW)</Typography>\r\n      </Box>\r\n      <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n        <CircleIcon sx={{ color: 'error.main', fontSize: 16 }} />\r\n        <Typography variant=\"body2\">Turn Off (No Heating)</Typography>\r\n      </Box>\r\n    </Stack>\r\n  );\r\n}\r\n","import { useQuery } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\n\r\nexport function useScheduleHistory() {\r\n  return useQuery({\r\n    queryKey: ['schedule', 'history'],\r\n    queryFn: () => apiClient.getScheduleHistory(),\r\n    staleTime: 60 * 1000, // 1 minute\r\n  });\r\n}\r\n","import { useState } from 'react';\r\nimport {\r\n  Accordion,\r\n  AccordionSummary,\r\n  AccordionDetails,\r\n  Typography,\r\n  Box,\r\n  Chip,\r\n  CircularProgress,\r\n  Alert,\r\n} from '@mui/material';\r\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\r\nimport { format } from 'date-fns';\r\nimport { useScheduleHistory } from '../hooks/useScheduleHistory';\r\nimport ScheduleGrid from './ScheduleGrid';\r\n\r\nexport default function ScheduleHistoryList() {\r\n  const { data, isLoading, error } = useScheduleHistory();\r\n  const [expanded, setExpanded] = useState<string | false>(false);\r\n\r\n  const handleChange = (panel: string) => (_: React.SyntheticEvent, isExpanded: boolean) => {\r\n    setExpanded(isExpanded ? panel : false);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Box sx={{ display: 'flex', justifyContent: 'center', p: 3 }}>\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Alert severity=\"error\">\r\n        Failed to load schedule history: {error.message}\r\n      </Alert>\r\n    );\r\n  }\r\n\r\n  if (!data || data.length === 0) {\r\n    return (\r\n      <Alert severity=\"info\">\r\n        No schedule history found. Generate a schedule to see it here.\r\n      </Alert>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box>\r\n      {data.map((entry, index) => {\r\n        const panelId = `history-${index}`;\r\n        const timestamp = new Date(entry.timestamp);\r\n        \r\n        return (\r\n          <Accordion\r\n            key={panelId}\r\n            expanded={expanded === panelId}\r\n            onChange={handleChange(panelId)}\r\n            sx={{ mb: 1 }}\r\n          >\r\n            <AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n              <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, width: '100%' }}>\r\n                <Typography>\r\n                  {format(timestamp, 'PPpp')}\r\n                </Typography>\r\n                <Chip label={entry.date} size=\"small\" />\r\n              </Box>\r\n            </AccordionSummary>\r\n            <AccordionDetails>\r\n              <ScheduleGrid schedulePayload={entry.schedule} />\r\n            </AccordionDetails>\r\n          </Accordion>\r\n        );\r\n      })}\r\n    </Box>\r\n  );\r\n}\r\n","import { Box, Typography, Paper } from '@mui/material';\r\n\r\ninterface JsonViewerProps {\r\n  data: unknown;\r\n  title?: string;\r\n}\r\n\r\nexport default function JsonViewer({ data, title }: JsonViewerProps) {\r\n  return (\r\n    <Paper sx={{ p: 2, bgcolor: 'background.default' }}>\r\n      {title && (\r\n        <Typography variant=\"subtitle2\" gutterBottom>\r\n          {title}\r\n        </Typography>\r\n      )}\r\n      <Box\r\n        component=\"pre\"\r\n        sx={{\r\n          fontFamily: 'monospace',\r\n          fontSize: '0.875rem',\r\n          overflow: 'auto',\r\n          maxHeight: 400,\r\n          margin: 0,\r\n        }}\r\n      >\r\n        {JSON.stringify(data, null, 2)}\r\n      </Box>\r\n    </Paper>\r\n  );\r\n}\r\n","import {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Button,\r\n  DialogContentText,\r\n} from '@mui/material';\r\n\r\ninterface ConfirmDialogProps {\r\n  open: boolean;\r\n  title: string;\r\n  message: string;\r\n  confirmText?: string;\r\n  cancelText?: string;\r\n  onConfirm: () => void;\r\n  onCancel: () => void;\r\n  isDestructive?: boolean;\r\n}\r\n\r\nexport default function ConfirmDialog({\r\n  open,\r\n  title,\r\n  message,\r\n  confirmText = 'Confirm',\r\n  cancelText = 'Cancel',\r\n  onConfirm,\r\n  onCancel,\r\n  isDestructive = false,\r\n}: ConfirmDialogProps) {\r\n  return (\r\n    <Dialog open={open} onClose={onCancel}>\r\n      <DialogTitle>{title}</DialogTitle>\r\n      <DialogContent>\r\n        <DialogContentText>{message}</DialogContentText>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onCancel}>{cancelText}</Button>\r\n        <Button\r\n          onClick={onConfirm}\r\n          variant=\"contained\"\r\n          color={isDestructive ? 'error' : 'primary'}\r\n          autoFocus\r\n        >\r\n          {confirmText}\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n","import { useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\n\r\nexport function useSchedulePreview() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: () => apiClient.getSchedulePreview(),\r\n    onSuccess: () => {\r\n      // Invalidate history to show newly persisted schedule\r\n      queryClient.invalidateQueries({ queryKey: ['schedule', 'history'] });\r\n    },\r\n  });\r\n}\r\n","import { useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\nimport type { SchedulePayload } from '../types/api';\r\n\r\ninterface ApplyScheduleParams {\r\n  gatewayDeviceId: string;\r\n  embeddedId: string;\r\n  schedulePayload: SchedulePayload;\r\n  mode?: string;\r\n  activateScheduleId?: string;\r\n}\r\n\r\nexport function useApplySchedule() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (params: ApplyScheduleParams) =>\r\n      apiClient.applySchedule(params),\r\n    onSuccess: () => {\r\n      // Invalidate current schedule to refetch updated state\r\n      queryClient.invalidateQueries({ queryKey: ['schedule', 'current'] });\r\n    },\r\n  });\r\n}\r\n","import { useMutation } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\n\r\nexport function useCurrentSchedule() {\r\n  return useMutation({\r\n    mutationFn: (embeddedId?: string) => apiClient.getCurrentSchedule(embeddedId),\r\n  });\r\n}\r\n","import { useQuery } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\nimport type { FlexibleState } from '../types/api';\r\n\r\nexport function useFlexibleState(enabled = true) {\r\n  const query = useQuery<FlexibleState>({\r\n    queryKey: ['user', 'flexible-state'],\r\n    queryFn: () => apiClient.getFlexibleState(),\r\n    staleTime: 30 * 1000, // 30 seconds\r\n    enabled,\r\n  });\r\n\r\n  return {\r\n    state: query.data,\r\n    isLoading: query.isLoading,\r\n    error: query.error,\r\n    refetch: query.refetch,\r\n  };\r\n}\r\n","import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\nimport type { UserSettings } from '../types/api';\r\n\r\nexport function useUserSettings() {\r\n  const queryClient = useQueryClient();\r\n\r\n  const query = useQuery({\r\n    queryKey: ['user', 'settings'],\r\n    queryFn: () => apiClient.getUserSettings(),\r\n    staleTime: 60 * 1000, // 1 minute\r\n  });\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: (settings: UserSettings) => apiClient.saveUserSettings(settings),\r\n    onSuccess: () => {\r\n      // Invalidate settings and schedule preview\r\n      queryClient.invalidateQueries({ queryKey: ['user', 'settings'] });\r\n      queryClient.invalidateQueries({ queryKey: ['schedule', 'preview'] });\r\n    },\r\n  });\r\n\r\n  return {\r\n    settings: query.data,\r\n    isLoading: query.isLoading,\r\n    error: query.error,\r\n    updateSettings: updateMutation.mutateAsync,\r\n    isUpdating: updateMutation.isPending,\r\n  };\r\n}\r\n","import { useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\n\r\nexport function useManualComfort() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (comfortTime: string) => apiClient.scheduleManualComfort(comfortTime),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['schedule'] });\r\n      queryClient.invalidateQueries({ queryKey: ['user', 'flexible-state'] });\r\n    },\r\n  });\r\n}\r\n","import { useState } from 'react';\r\nimport { Stack, Paper, Typography, Button, Alert, Box, Snackbar, TextField, Divider } from '@mui/material';\r\nimport AuthStatusChip from '../components/AuthStatusChip';\r\nimport PriceChart from '../components/PriceChart';\r\nimport ScheduleGrid from '../components/ScheduleGrid';\r\nimport ScheduleLegend from '../components/ScheduleLegend';\r\nimport ScheduleHistoryList from '../components/ScheduleHistoryList';\r\nimport JsonViewer from '../components/JsonViewer';\r\nimport ConfirmDialog from '../components/ConfirmDialog';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport { useSchedulePreview } from '../hooks/useSchedulePreview';\r\nimport { useApplySchedule } from '../hooks/useApplySchedule';\r\nimport { useCurrentSchedule } from '../hooks/useCurrentSchedule';\r\nimport { useFlexibleState } from '../hooks/useFlexibleState';\r\nimport { useUserSettings } from '../hooks/useUserSettings';\r\nimport { useManualComfort } from '../hooks/useManualComfort';\r\n\r\nexport default function DashboardPage() {\r\n  const { isAuthorized, startAuth, refresh, isRefreshing } = useAuth();\r\n  const schedulePreview = useSchedulePreview();\r\n\r\n  // New state\r\n  const [snackbar, setSnackbar] = useState<{\r\n    open: boolean;\r\n    message: string;\r\n    severity: 'success' | 'error' | 'info' | 'warning';\r\n  }>({ open: false, message: '', severity: 'info' });\r\n\r\n  const [applyDialog, setApplyDialog] = useState(false);\r\n  const [deviceIds, setDeviceIds] = useState({ gateway: '', embedded: '' });\r\n\r\n  // New hooks\r\n  const applySchedule = useApplySchedule();\r\n  const currentSchedule = useCurrentSchedule();\r\n  const { settings } = useUserSettings();\r\n  const isFlexible = settings?.SchedulingMode === 'Flexible';\r\n  const { state: flexibleState } = useFlexibleState(isFlexible);\r\n  const manualComfort = useManualComfort();\r\n\r\n  const formatDateTimeLocal = (date: Date): string => {\r\n    const pad = (n: number) => n.toString().padStart(2, '0');\r\n    return `${date.getFullYear()}-${pad(date.getMonth() + 1)}-${pad(date.getDate())}T${pad(date.getHours())}:${pad(date.getMinutes())}`;\r\n  };\r\n\r\n  const [manualComfortTime, setManualComfortTime] = useState(() => {\r\n    const nextHour = new Date();\r\n    nextHour.setHours(nextHour.getHours() + 1, 0, 0, 0);\r\n    return formatDateTimeLocal(nextHour);\r\n  });\r\n\r\n  const handleManualComfort = async () => {\r\n    if (!manualComfortTime) return;\r\n    try {\r\n      const comfortDate = new Date(manualComfortTime);\r\n      const result = await manualComfort.mutateAsync(comfortDate.toISOString());\r\n      setSnackbar({\r\n        open: true,\r\n        message: result.message,\r\n        severity: result.applied ? 'success' : 'warning',\r\n      });\r\n    } catch (error) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: `Failed to schedule comfort: ${error}`,\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleGenerateSchedule = async () => {\r\n    try {\r\n      await schedulePreview.mutateAsync();\r\n    } catch (error) {\r\n      console.error('Failed to generate schedule:', error);\r\n    }\r\n  };\r\n\r\n  const handleApplySchedule = async () => {\r\n    if (!schedulePreview.data?.schedulePayload) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'No schedule to apply. Generate a schedule first.',\r\n        severity: 'error',\r\n      });\r\n      return;\r\n    }\r\n\r\n    setApplyDialog(true);\r\n  };\r\n\r\n  const confirmApplySchedule = async () => {\r\n    setApplyDialog(false);\r\n\r\n    if (!deviceIds.gateway || !deviceIds.embedded) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Gateway Device ID and Embedded ID are required',\r\n        severity: 'error',\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await applySchedule.mutateAsync({\r\n        gatewayDeviceId: deviceIds.gateway,\r\n        embeddedId: deviceIds.embedded,\r\n        schedulePayload: schedulePreview.data!.schedulePayload!,\r\n      });\r\n\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Schedule applied successfully!',\r\n        severity: 'success',\r\n      });\r\n    } catch (error) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: `Failed to apply schedule: ${error}`,\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleRetrieveCurrentSchedule = async () => {\r\n    try {\r\n      await currentSchedule.mutateAsync(deviceIds.embedded || undefined);\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Current schedule retrieved',\r\n        severity: 'success',\r\n      });\r\n    } catch (error) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: `Failed to retrieve schedule: ${error}`,\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Stack spacing={3}>\r\n      {/* Auth Section */}\r\n      <Paper sx={{ p: 3 }}>\r\n        <Stack direction=\"row\" spacing={2} alignItems=\"center\" sx={{ mb: 2 }}>\r\n          <Typography variant=\"h5\">Daikin Authorization</Typography>\r\n          <AuthStatusChip />\r\n        </Stack>\r\n        \r\n        <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\r\n          {!isAuthorized ? (\r\n            <Button variant=\"contained\" onClick={startAuth}>\r\n              Start OAuth Flow\r\n            </Button>\r\n          ) : (\r\n            <Button\r\n              variant=\"outlined\"\r\n              onClick={() => refresh()}\r\n              disabled={isRefreshing}\r\n            >\r\n              {isRefreshing ? 'Refreshing...' : 'Refresh Token'}\r\n            </Button>\r\n          )}\r\n        </Stack>\r\n      </Paper>\r\n\r\n      {/* Price Chart */}\r\n      <PriceChart />\r\n\r\n      {/* Schedule Preview */}\r\n      <Paper sx={{ p: 3 }}>\r\n        <Typography variant=\"h5\" gutterBottom>\r\n          Schedule Preview\r\n        </Typography>\r\n\r\n        {!isAuthorized && (\r\n          <Alert severity=\"warning\" sx={{ mb: 2 }}>\r\n            Authorize with Daikin to apply schedules to your device\r\n          </Alert>\r\n        )}\r\n\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={handleGenerateSchedule}\r\n          disabled={schedulePreview.isPending}\r\n          sx={{ mb: 2 }}\r\n        >\r\n          {schedulePreview.isPending ? 'Generating...' : 'Generate Schedule'}\r\n        </Button>\r\n\r\n        {schedulePreview.isError && (\r\n          <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n            Failed to generate schedule: {schedulePreview.error.message}\r\n          </Alert>\r\n        )}\r\n\r\n        {schedulePreview.data && (\r\n          <Box>\r\n            <ScheduleGrid schedulePayload={schedulePreview.data.schedulePayload} />\r\n            <ScheduleLegend />\r\n            \r\n            {schedulePreview.data.message && (\r\n              <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 2 }}>\r\n                {schedulePreview.data.message}\r\n              </Typography>\r\n            )}\r\n          </Box>\r\n        )}\r\n      </Paper>\r\n\r\n      {/* Manual Comfort Run */}\r\n      <Paper sx={{ p: 3 }}>\r\n        <Typography variant=\"h5\" gutterBottom>\r\n          Manual Comfort Run\r\n        </Typography>\r\n        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n          Schedule an immediate comfort run (e.g., for filling a hot tub). Select a time within the next 48 hours.\r\n        </Typography>\r\n\r\n        <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2} alignItems=\"flex-end\">\r\n          <TextField\r\n            type=\"datetime-local\"\r\n            label=\"Comfort Time\"\r\n            value={manualComfortTime}\r\n            onChange={(e) => setManualComfortTime(e.target.value)}\r\n            InputLabelProps={{ shrink: true }}\r\n            inputProps={{\r\n              min: formatDateTimeLocal(new Date()),\r\n              max: formatDateTimeLocal(new Date(Date.now() + 48 * 60 * 60 * 1000)),\r\n            }}\r\n            fullWidth\r\n          />\r\n          <Button\r\n            variant=\"contained\"\r\n            onClick={handleManualComfort}\r\n            disabled={!isAuthorized || !manualComfortTime || manualComfort.isPending}\r\n            sx={{ whiteSpace: 'nowrap', minWidth: 160 }}\r\n          >\r\n            {manualComfort.isPending ? 'Scheduling...' : 'Schedule & Apply'}\r\n          </Button>\r\n        </Stack>\r\n\r\n        {!isAuthorized && (\r\n          <Alert severity=\"warning\" sx={{ mt: 2 }}>\r\n            Authorize with Daikin before scheduling a manual comfort run.\r\n          </Alert>\r\n        )}\r\n      </Paper>\r\n\r\n      {/* Flexible Scheduling Status */}\r\n      {isFlexible && flexibleState && (\r\n        <Paper sx={{ p: 3 }}>\r\n          <Typography variant=\"h5\" gutterBottom>\r\n            Flexible Scheduling Status\r\n          </Typography>\r\n\r\n          <Stack spacing={2}>\r\n            {/* Eco Status */}\r\n            <Box>\r\n              <Typography variant=\"subtitle1\" fontWeight=\"bold\">\r\n                Eco (Daily DHW)\r\n              </Typography>\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                Last run: {flexibleState.LastEcoRunUtc\r\n                  ? new Date(flexibleState.LastEcoRunUtc).toLocaleString()\r\n                  : 'Never (waiting for first interval)'}\r\n              </Typography>\r\n              {flexibleState.EcoWindow.Start && flexibleState.EcoWindow.End && (\r\n                <Typography variant=\"body2\" color=\"text.secondary\">\r\n                  Next window: {new Date(flexibleState.EcoWindow.Start).toLocaleString()} – {new Date(flexibleState.EcoWindow.End).toLocaleString()}\r\n                </Typography>\r\n              )}\r\n            </Box>\r\n\r\n            <Divider />\r\n\r\n            {/* Comfort Status */}\r\n            <Box>\r\n              <Typography variant=\"subtitle1\" fontWeight=\"bold\">\r\n                Comfort (Legionella)\r\n              </Typography>\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                Last run: {flexibleState.LastComfortRunUtc\r\n                  ? new Date(flexibleState.LastComfortRunUtc).toLocaleString()\r\n                  : 'Never (waiting for first interval)'}\r\n              </Typography>\r\n              {flexibleState.NextScheduledComfortUtc && (\r\n                <Typography variant=\"body2\" color=\"primary.main\">\r\n                  Next scheduled: {new Date(flexibleState.NextScheduledComfortUtc).toLocaleString()}\r\n                </Typography>\r\n              )}\r\n              {flexibleState.ComfortWindow.Start && flexibleState.ComfortWindow.End && (\r\n                <>\r\n                  <Typography variant=\"body2\" color=\"text.secondary\">\r\n                    Window: {new Date(flexibleState.ComfortWindow.Start).toLocaleString()} – {new Date(flexibleState.ComfortWindow.End).toLocaleString()}\r\n                  </Typography>\r\n                  {flexibleState.ComfortWindow.Progress !== null && (\r\n                    <Box sx={{ mt: 1 }}>\r\n                      <Typography variant=\"caption\" color=\"text.secondary\">\r\n                        Window progress: {(flexibleState.ComfortWindow.Progress * 100).toFixed(0)}%\r\n                      </Typography>\r\n                      <Box\r\n                        sx={{\r\n                          mt: 0.5,\r\n                          height: 8,\r\n                          borderRadius: 4,\r\n                          bgcolor: 'grey.200',\r\n                          overflow: 'hidden',\r\n                        }}\r\n                      >\r\n                        <Box\r\n                          sx={{\r\n                            height: '100%',\r\n                            width: `${(flexibleState.ComfortWindow.Progress ?? 0) * 100}%`,\r\n                            bgcolor: (flexibleState.ComfortWindow.Progress ?? 0) > 0.9\r\n                              ? 'warning.main'\r\n                              : 'primary.main',\r\n                            borderRadius: 4,\r\n                            transition: 'width 0.3s ease',\r\n                          }}\r\n                        />\r\n                      </Box>\r\n                    </Box>\r\n                  )}\r\n                </>\r\n              )}\r\n            </Box>\r\n          </Stack>\r\n        </Paper>\r\n      )}\r\n\r\n      {/* Apply Schedule Section */}\r\n      <Paper sx={{ p: 3 }}>\r\n        <Typography variant=\"h5\" gutterBottom>\r\n          Apply Schedule to Daikin\r\n        </Typography>\r\n\r\n        <Stack spacing={2}>\r\n          <TextField\r\n            label=\"Gateway Device ID\"\r\n            value={deviceIds.gateway}\r\n            onChange={(e) => setDeviceIds({ ...deviceIds, gateway: e.target.value })}\r\n            placeholder=\"Enter gateway device ID\"\r\n            fullWidth\r\n            disabled={!isAuthorized}\r\n          />\r\n          \r\n          <TextField\r\n            label=\"Embedded ID\"\r\n            value={deviceIds.embedded}\r\n            onChange={(e) => setDeviceIds({ ...deviceIds, embedded: e.target.value })}\r\n            placeholder=\"Enter embedded ID\"\r\n            fullWidth\r\n            disabled={!isAuthorized}\r\n          />\r\n\r\n          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\r\n            <Button\r\n              variant=\"contained\"\r\n              onClick={handleApplySchedule}\r\n              disabled={!isAuthorized || !schedulePreview.data?.schedulePayload || applySchedule.isPending}\r\n            >\r\n              {applySchedule.isPending ? 'Applying...' : 'Apply Schedule'}\r\n            </Button>\r\n\r\n            <Button\r\n              variant=\"outlined\"\r\n              onClick={handleRetrieveCurrentSchedule}\r\n              disabled={!isAuthorized || currentSchedule.isPending}\r\n            >\r\n              {currentSchedule.isPending ? 'Retrieving...' : 'Retrieve Current Schedule'}\r\n            </Button>\r\n          </Stack>\r\n        </Stack>\r\n\r\n        {!!currentSchedule.data && (\r\n          <Box sx={{ mt: 3 }}>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              Current Schedule\r\n            </Typography>\r\n            <JsonViewer data={currentSchedule.data} />\r\n          </Box>\r\n        )}\r\n      </Paper>\r\n\r\n      {/* History Section */}\r\n      <Paper sx={{ p: 3 }}>\r\n        <Typography variant=\"h5\" gutterBottom>\r\n          Schedule History\r\n        </Typography>\r\n        <ScheduleHistoryList />\r\n      </Paper>\r\n\r\n      {/* Dialogs and Snackbar */}\r\n      <ConfirmDialog\r\n        open={applyDialog}\r\n        title=\"Apply Schedule\"\r\n        message=\"Are you sure you want to apply this schedule to your Daikin device? This will replace the current schedule.\"\r\n        confirmText=\"Apply\"\r\n        cancelText=\"Cancel\"\r\n        onConfirm={confirmApplySchedule}\r\n        onCancel={() => setApplyDialog(false)}\r\n      />\r\n\r\n      <Snackbar\r\n        open={snackbar.open}\r\n        autoHideDuration={6000}\r\n        onClose={() => setSnackbar({ ...snackbar, open: false })}\r\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\r\n      >\r\n        <Alert\r\n          onClose={() => setSnackbar({ ...snackbar, open: false })}\r\n          severity={snackbar.severity}\r\n          sx={{ width: '100%' }}\r\n        >\r\n          {snackbar.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Stack>\r\n  );\r\n}\r\n","import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\n\r\nexport function useZone() {\r\n  const queryClient = useQueryClient();\r\n\r\n  const query = useQuery({\r\n    queryKey: ['user', 'zone'],\r\n    queryFn: async () => {\r\n      const response = await apiClient.getZone();\r\n      return response.zone;\r\n    },\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n  });\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: (zone: string) => apiClient.setZone(zone),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['user', 'zone'] });\r\n      queryClient.invalidateQueries({ queryKey: ['prices', 'timeseries'] });\r\n      queryClient.invalidateQueries({ queryKey: ['schedule', 'preview'] });\r\n    },\r\n  });\r\n\r\n  return {\r\n    zone: query.data,\r\n    isLoading: query.isLoading,\r\n    error: query.error,\r\n    setZone: updateMutation.mutateAsync,\r\n    isUpdating: updateMutation.isPending,\r\n  };\r\n}\r\n","import { Paper, Skeleton, Stack } from '@mui/material';\r\n\r\nexport default function LoadingSkeleton() {\r\n  return (\r\n    <Stack spacing={3}>\r\n      <Paper sx={{ p: 3 }}>\r\n        <Skeleton variant=\"text\" width=\"40%\" height={40} />\r\n        <Skeleton variant=\"rectangular\" height={200} sx={{ mt: 2 }} />\r\n      </Paper>\r\n      <Paper sx={{ p: 3 }}>\r\n        <Skeleton variant=\"text\" width=\"30%\" height={40} />\r\n        <Skeleton variant=\"rectangular\" height={150} sx={{ mt: 2 }} />\r\n      </Paper>\r\n      <Paper sx={{ p: 3 }}>\r\n        <Skeleton variant=\"text\" width=\"50%\" height={40} />\r\n        <Skeleton variant=\"rectangular\" height={100} sx={{ mt: 2 }} />\r\n      </Paper>\r\n    </Stack>\r\n  );\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport {\r\n  Container,\r\n  Paper,\r\n  Typography,\r\n  Stack,\r\n  Slider,\r\n  TextField,\r\n  Switch,\r\n  FormControlLabel,\r\n  Button,\r\n  Divider,\r\n  Box,\r\n  Alert,\r\n  Snackbar,\r\n  Select,\r\n  MenuItem,\r\n  FormControl,\r\n  InputLabel,\r\n  CircularProgress,\r\n} from '@mui/material';\r\nimport { useUserSettings } from '../hooks/useUserSettings';\r\nimport { useZone } from '../hooks/useZone';\r\nimport { useAuth } from '../hooks/useAuth';\r\nimport ConfirmDialog from '../components/ConfirmDialog';\r\nimport LoadingSkeleton from '../components/LoadingSkeleton';\r\n\r\n// Nordpool zones\r\nconst ZONES = [\r\n  'SE1', 'SE2', 'SE3', 'SE4',\r\n  'NO1', 'NO2', 'NO3', 'NO4', 'NO5',\r\n  'DK1', 'DK2',\r\n  'FI',\r\n];\r\n\r\nexport default function SettingsPage() {\r\n  const { settings, isLoading, error, updateSettings, isUpdating } = useUserSettings();\r\n  const { zone, setZone, isUpdating: isZoneUpdating } = useZone();\r\n  const { isAuthorized, refresh, revoke, isRefreshing } = useAuth();\r\n\r\n  // Local state for form\r\n  const [formData, setFormData] = useState({\r\n    comfortHours: 3,\r\n    turnOffPercentile: 0.9,\r\n    maxComfortGapHours: 1,\r\n    autoApplySchedule: false,\r\n    selectedZone: 'SE3',\r\n    schedulingMode: 'Classic' as 'Classic' | 'Flexible',\r\n    ecoIntervalHours: 24,\r\n    ecoFlexibilityHours: 12,\r\n    comfortIntervalDays: 21,\r\n    comfortFlexibilityDays: 7,\r\n    comfortEarlyPercentile: 0.10,\r\n  });\r\n\r\n  const [snackbar, setSnackbar] = useState({\r\n    open: false,\r\n    message: '',\r\n    severity: 'success' as 'success' | 'error' | 'info',\r\n  });\r\n\r\n  const [revokeDialog, setRevokeDialog] = useState(false);\r\n\r\n  // Initialize form from settings\r\n  useEffect(() => {\r\n    if (settings) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        comfortHours: settings.ComfortHours ?? 3,\r\n        turnOffPercentile: settings.TurnOffPercentile ?? 0.9,\r\n        maxComfortGapHours: settings.MaxComfortGapHours ?? 1,\r\n        autoApplySchedule: settings.AutoApplySchedule ?? false,\r\n        schedulingMode: settings.SchedulingMode ?? 'Classic',\r\n        ecoIntervalHours: settings.EcoIntervalHours ?? 24,\r\n        ecoFlexibilityHours: settings.EcoFlexibilityHours ?? 12,\r\n        comfortIntervalDays: settings.ComfortIntervalDays ?? 21,\r\n        comfortFlexibilityDays: settings.ComfortFlexibilityDays ?? 7,\r\n        comfortEarlyPercentile: settings.ComfortEarlyPercentile ?? 0.10,\r\n      }));\r\n    }\r\n  }, [settings]);\r\n\r\n  useEffect(() => {\r\n    if (zone) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        selectedZone: zone\r\n      }));\r\n    }\r\n  }, [zone]);\r\n\r\n\r\n  const handleSaveSettings = async () => {\r\n    try {\r\n      await updateSettings({\r\n        ComfortHours: formData.comfortHours,\r\n        TurnOffPercentile: formData.turnOffPercentile,\r\n        MaxComfortGapHours: formData.maxComfortGapHours,\r\n        AutoApplySchedule: formData.autoApplySchedule,\r\n        SchedulingMode: formData.schedulingMode,\r\n        EcoIntervalHours: formData.ecoIntervalHours,\r\n        EcoFlexibilityHours: formData.ecoFlexibilityHours,\r\n        ComfortIntervalDays: formData.comfortIntervalDays,\r\n        ComfortFlexibilityDays: formData.comfortFlexibilityDays,\r\n        ComfortEarlyPercentile: formData.comfortEarlyPercentile,\r\n      });\r\n\r\n      if (formData.selectedZone !== zone) {\r\n        await setZone(formData.selectedZone);\r\n      }\r\n\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Settings saved successfully',\r\n        severity: 'success',\r\n      });\r\n    } catch (err) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: `Failed to save settings: ${err}`,\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleRevokeToken = async () => {\r\n    setRevokeDialog(false);\r\n    try {\r\n      await revoke();\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Daikin authentication revoked',\r\n        severity: 'info',\r\n      });\r\n    } catch (err) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: `Failed to revoke: ${err}`,\r\n        severity: 'error',\r\n      });\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Container maxWidth=\"md\" sx={{ py: 4 }}>\r\n        <LoadingSkeleton />\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Container maxWidth=\"md\" sx={{ py: 4 }}>\r\n        <Alert severity=\"error\">Failed to load settings: {error.message}</Alert>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container maxWidth=\"md\" sx={{ py: 4 }}>\r\n      <Typography variant=\"h4\" gutterBottom sx={{ fontSize: { xs: '1.5rem', md: '2rem' } }}>\r\n        Settings\r\n      </Typography>\r\n\r\n      <Stack spacing={3}>\r\n        {/* Schedule Settings */}\r\n        <Paper sx={{ p: 3 }}>\r\n          <Typography variant=\"h6\" gutterBottom>\r\n            Schedule Configuration\r\n          </Typography>\r\n\r\n          <Stack spacing={3}>\r\n            <Box>\r\n              <Typography gutterBottom>\r\n                Comfort Hours: {formData.comfortHours}\r\n              </Typography>\r\n              <Slider\r\n                value={formData.comfortHours}\r\n                onChange={(_, value) =>\r\n                  setFormData({ ...formData, comfortHours: value as number })\r\n                }\r\n                min={1}\r\n                max={12}\r\n                step={1}\r\n                marks\r\n                valueLabelDisplay=\"auto\"\r\n              />\r\n              <Typography variant=\"caption\" color=\"text.secondary\">\r\n                Number of hours per day to heat water to comfort temperature\r\n              </Typography>\r\n            </Box>\r\n\r\n            <Box>\r\n              <Typography gutterBottom>\r\n                Turn Off Percentile: {(formData.turnOffPercentile * 100).toFixed(0)}%\r\n              </Typography>\r\n              <Slider\r\n                value={formData.turnOffPercentile}\r\n                onChange={(_, value) =>\r\n                  setFormData({ ...formData, turnOffPercentile: value as number })\r\n                }\r\n                min={0.5}\r\n                max={0.99}\r\n                step={0.01}\r\n                marks={[\r\n                  { value: 0.5, label: '50%' },\r\n                  { value: 0.75, label: '75%' },\r\n                  { value: 0.99, label: '99%' },\r\n                ]}\r\n                valueLabelDisplay=\"auto\"\r\n                valueLabelFormat={(value) => `${(value * 100).toFixed(0)}%`}\r\n              />\r\n              <Typography variant=\"caption\" color=\"text.secondary\">\r\n                Price threshold for turning off DHW heating (higher = less turn-off)\r\n              </Typography>\r\n            </Box>\r\n\r\n            <TextField\r\n              label=\"Max Comfort Gap (hours)\"\r\n              type=\"number\"\r\n              value={formData.maxComfortGapHours}\r\n              onChange={(e) =>\r\n                setFormData({\r\n                  ...formData,\r\n                  maxComfortGapHours: parseInt(e.target.value) || 1,\r\n                })\r\n              }\r\n              inputProps={{ min: 1, max: 72, step: 1 }}\r\n              helperText=\"Maximum gap between consecutive comfort hours (1-72)\"\r\n            />\r\n\r\n            <FormControl fullWidth>\r\n              <InputLabel>Nordpool Zone</InputLabel>\r\n              <Select\r\n                value={formData.selectedZone}\r\n                onChange={(e) =>\r\n                  setFormData({ ...formData, selectedZone: e.target.value })\r\n                }\r\n                label=\"Nordpool Zone\"\r\n              >\r\n                {ZONES.map((z) => (\r\n                  <MenuItem key={z} value={z}>\r\n                    {z}\r\n                  </MenuItem>\r\n                ))}\r\n              </Select>\r\n            </FormControl>\r\n          </Stack>\r\n        </Paper>\r\n\r\n        {/* Scheduling Mode */}\r\n        <Paper sx={{ p: 3 }}>\r\n          <Typography variant=\"h6\" gutterBottom>\r\n            Scheduling Mode\r\n          </Typography>\r\n\r\n          <Stack spacing={2}>\r\n            <FormControl fullWidth>\r\n              <InputLabel>Mode</InputLabel>\r\n              <Select\r\n                value={formData.schedulingMode}\r\n                onChange={(e) => setFormData({ ...formData, schedulingMode: e.target.value as 'Classic' | 'Flexible' })}\r\n                label=\"Mode\"\r\n              >\r\n                <MenuItem value=\"Classic\">Classic (Fixed daily schedule)</MenuItem>\r\n                <MenuItem value=\"Flexible\">Flexible (Interval-based with price optimization)</MenuItem>\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <Typography variant=\"caption\" color=\"text.secondary\">\r\n              Classic mode generates a fixed daily schedule. Flexible mode schedules eco and comfort runs at optimal prices within configurable intervals.\r\n            </Typography>\r\n          </Stack>\r\n        </Paper>\r\n\r\n        {/* Flexible Scheduling Settings - only show when Flexible mode */}\r\n        {formData.schedulingMode === 'Flexible' && (\r\n          <Paper sx={{ p: 3 }}>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              Flexible Schedule Settings\r\n            </Typography>\r\n\r\n            <Stack spacing={3}>\r\n              {/* Eco Section */}\r\n              <Typography variant=\"subtitle1\" fontWeight=\"bold\">Eco (Daily DHW ~45°C)</Typography>\r\n\r\n              <Box>\r\n                <Typography gutterBottom>\r\n                  Eco Interval: {formData.ecoIntervalHours} hours\r\n                </Typography>\r\n                <Slider\r\n                  value={formData.ecoIntervalHours}\r\n                  onChange={(_, value) => setFormData({ ...formData, ecoIntervalHours: value as number })}\r\n                  min={6}\r\n                  max={36}\r\n                  step={1}\r\n                  marks={[\r\n                    { value: 6, label: '6h' },\r\n                    { value: 12, label: '12h' },\r\n                    { value: 24, label: '24h' },\r\n                    { value: 36, label: '36h' },\r\n                  ]}\r\n                  valueLabelDisplay=\"auto\"\r\n                />\r\n                <Typography variant=\"caption\" color=\"text.secondary\">\r\n                  How often eco heating should run (target interval)\r\n                </Typography>\r\n              </Box>\r\n\r\n              <Box>\r\n                <Typography gutterBottom>\r\n                  Eco Flexibility: ±{formData.ecoFlexibilityHours} hours\r\n                </Typography>\r\n                <Slider\r\n                  value={formData.ecoFlexibilityHours}\r\n                  onChange={(_, value) => setFormData({ ...formData, ecoFlexibilityHours: value as number })}\r\n                  min={1}\r\n                  max={18}\r\n                  step={1}\r\n                  marks={[\r\n                    { value: 1, label: '±1h' },\r\n                    { value: 6, label: '±6h' },\r\n                    { value: 12, label: '±12h' },\r\n                    { value: 18, label: '±18h' },\r\n                  ]}\r\n                  valueLabelDisplay=\"auto\"\r\n                />\r\n                <Typography variant=\"caption\" color=\"text.secondary\">\r\n                  Scheduling window: eco runs between {Math.max(0, formData.ecoIntervalHours - formData.ecoFlexibilityHours)}h and {formData.ecoIntervalHours + formData.ecoFlexibilityHours}h after last run\r\n                </Typography>\r\n              </Box>\r\n\r\n              <Divider />\r\n\r\n              {/* Comfort Section */}\r\n              <Typography variant=\"subtitle1\" fontWeight=\"bold\">Comfort (Legionella ~60°C)</Typography>\r\n\r\n              <Box>\r\n                <Typography gutterBottom>\r\n                  Comfort Interval: {formData.comfortIntervalDays} days\r\n                </Typography>\r\n                <Slider\r\n                  value={formData.comfortIntervalDays}\r\n                  onChange={(_, value) => setFormData({ ...formData, comfortIntervalDays: value as number })}\r\n                  min={7}\r\n                  max={90}\r\n                  step={1}\r\n                  marks={[\r\n                    { value: 7, label: '7d' },\r\n                    { value: 21, label: '21d' },\r\n                    { value: 30, label: '30d' },\r\n                    { value: 60, label: '60d' },\r\n                    { value: 90, label: '90d' },\r\n                  ]}\r\n                  valueLabelDisplay=\"auto\"\r\n                />\r\n                <Typography variant=\"caption\" color=\"text.secondary\">\r\n                  How often comfort (legionella) heating should run\r\n                </Typography>\r\n              </Box>\r\n\r\n              <Box>\r\n                <Typography gutterBottom>\r\n                  Comfort Flexibility: ±{formData.comfortFlexibilityDays} days\r\n                </Typography>\r\n                <Slider\r\n                  value={formData.comfortFlexibilityDays}\r\n                  onChange={(_, value) => setFormData({ ...formData, comfortFlexibilityDays: value as number })}\r\n                  min={1}\r\n                  max={30}\r\n                  step={1}\r\n                  marks={[\r\n                    { value: 1, label: '±1d' },\r\n                    { value: 7, label: '±7d' },\r\n                    { value: 14, label: '±14d' },\r\n                    { value: 30, label: '±30d' },\r\n                  ]}\r\n                  valueLabelDisplay=\"auto\"\r\n                />\r\n                <Typography variant=\"caption\" color=\"text.secondary\">\r\n                  Scheduling window: comfort runs between {Math.max(0, formData.comfortIntervalDays - formData.comfortFlexibilityDays)}d and {formData.comfortIntervalDays + formData.comfortFlexibilityDays}d after last run\r\n                </Typography>\r\n              </Box>\r\n\r\n              <Box>\r\n                <Typography gutterBottom>\r\n                  Early Comfort Threshold: {(formData.comfortEarlyPercentile * 100).toFixed(0)}th percentile\r\n                </Typography>\r\n                <Slider\r\n                  value={formData.comfortEarlyPercentile}\r\n                  onChange={(_, value) => setFormData({ ...formData, comfortEarlyPercentile: value as number })}\r\n                  min={0.01}\r\n                  max={0.50}\r\n                  step={0.01}\r\n                  marks={[\r\n                    { value: 0.05, label: '5%' },\r\n                    { value: 0.10, label: '10%' },\r\n                    { value: 0.25, label: '25%' },\r\n                    { value: 0.50, label: '50%' },\r\n                  ]}\r\n                  valueLabelDisplay=\"auto\"\r\n                  valueLabelFormat={(value) => `${(value * 100).toFixed(0)}%`}\r\n                />\r\n                <Typography variant=\"caption\" color=\"text.secondary\">\r\n                  When the comfort window opens, only trigger if the price is below this historical percentile. The threshold relaxes as the window progresses.\r\n                </Typography>\r\n              </Box>\r\n            </Stack>\r\n          </Paper>\r\n        )}\r\n\r\n        {/* Automation Settings */}\r\n        <Paper sx={{ p: 3 }}>\r\n          <Typography variant=\"h6\" gutterBottom>\r\n            Automation\r\n          </Typography>\r\n\r\n          <FormControlLabel\r\n            control={\r\n              <Switch\r\n                checked={formData.autoApplySchedule}\r\n                onChange={(e) =>\r\n                  setFormData({ ...formData, autoApplySchedule: e.target.checked })\r\n                }\r\n              />\r\n            }\r\n            label=\"Auto-apply schedule daily\"\r\n          />\r\n          <Typography variant=\"caption\" color=\"text.secondary\" display=\"block\">\r\n            Automatically apply generated schedule to your Daikin device each day\r\n          </Typography>\r\n        </Paper>\r\n\r\n        {/* Save Button */}\r\n        <Button\r\n          variant=\"contained\"\r\n          size=\"large\"\r\n          onClick={handleSaveSettings}\r\n          disabled={isUpdating || isZoneUpdating}\r\n        >\r\n          {isUpdating || isZoneUpdating ? (\r\n            <>\r\n              <CircularProgress size={20} sx={{ mr: 1 }} />\r\n              Saving...\r\n            </>\r\n          ) : (\r\n            'Save Settings'\r\n          )}\r\n        </Button>\r\n\r\n        <Divider />\r\n\r\n        {/* Danger Zone */}\r\n        <Paper sx={{ p: 3, border: '1px solid', borderColor: 'error.main' }}>\r\n          <Typography variant=\"h6\" color=\"error\" gutterBottom>\r\n            Danger Zone\r\n          </Typography>\r\n\r\n          <Stack spacing={2}>\r\n            <Box>\r\n              <Typography variant=\"body2\" gutterBottom>\r\n                Revoke Daikin authentication to disconnect your account.\r\n              </Typography>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"error\"\r\n                onClick={() => setRevokeDialog(true)}\r\n                disabled={!isAuthorized}\r\n              >\r\n                Revoke Daikin Access\r\n              </Button>\r\n            </Box>\r\n\r\n            <Box>\r\n              <Typography variant=\"body2\" gutterBottom>\r\n                Refresh authentication token (use if experiencing connectivity issues).\r\n              </Typography>\r\n              <Button\r\n                variant=\"outlined\"\r\n                onClick={() => refresh()}\r\n                disabled={!isAuthorized || isRefreshing}\r\n              >\r\n                {isRefreshing ? 'Refreshing...' : 'Refresh Token'}\r\n              </Button>\r\n            </Box>\r\n          </Stack>\r\n        </Paper>\r\n      </Stack>\r\n\r\n      {/* Dialogs */}\r\n      <ConfirmDialog\r\n        open={revokeDialog}\r\n        title=\"Revoke Daikin Access\"\r\n        message=\"Are you sure you want to revoke access to your Daikin account? You will need to re-authorize to use schedule application features.\"\r\n        confirmText=\"Revoke\"\r\n        cancelText=\"Cancel\"\r\n        onConfirm={handleRevokeToken}\r\n        onCancel={() => setRevokeDialog(false)}\r\n        isDestructive\r\n      />\r\n\r\n      <Snackbar\r\n        open={snackbar.open}\r\n        autoHideDuration={6000}\r\n        onClose={() => setSnackbar({ ...snackbar, open: false })}\r\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\r\n      >\r\n        <Alert\r\n          onClose={() => setSnackbar({ ...snackbar, open: false })}\r\n          severity={snackbar.severity}\r\n        >\r\n          {snackbar.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Container>\r\n  );\r\n}\r\n","import { useState } from 'react';\r\nimport {\r\n  Container,\r\n  Paper,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  Alert,\r\n  Snackbar,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  Switch,\r\n  Chip,\r\n  Tooltip,\r\n  CircularProgress,\r\n  Stack,\r\n  Box,\r\n} from '@mui/material';\r\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\r\nimport CancelIcon from '@mui/icons-material/Cancel';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogContentText from '@mui/material/DialogContentText';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient } from '../api/client';\r\nimport type { AdminUser } from '../types/api';\r\n\r\nexport default function AdminPage() {\r\n  const queryClient = useQueryClient();\r\n  const [password, setPassword] = useState('');\r\n  const [loginError, setLoginError] = useState<string | null>(null);\r\n  const [snackbar, setSnackbar] = useState<{ open: boolean; message: string; severity: 'error' | 'success' }>({ open: false, message: '', severity: 'error' });\r\n  const [pendingToggles, setPendingToggles] = useState<Set<string>>(new Set());\r\n  const [deleteTarget, setDeleteTarget] = useState<AdminUser | null>(null);\r\n\r\n  const statusQuery = useQuery({\r\n    queryKey: ['admin-status'],\r\n    queryFn: () => apiClient.getAdminStatus(),\r\n  });\r\n\r\n  const isAdmin = statusQuery.data?.isAdmin ?? false;\r\n\r\n  const usersQuery = useQuery({\r\n    queryKey: ['admin-users'],\r\n    queryFn: () => apiClient.getAdminUsers(),\r\n    enabled: isAdmin,\r\n  });\r\n\r\n  const loginMutation = useMutation({\r\n    mutationFn: (pw: string) => apiClient.adminLogin(pw),\r\n    onSuccess: () => {\r\n      setLoginError(null);\r\n      setPassword('');\r\n      queryClient.invalidateQueries({ queryKey: ['admin-status'] });\r\n    },\r\n    onError: (err: Error) => {\r\n      setLoginError(err.message || 'Login failed');\r\n    },\r\n  });\r\n\r\n  const toggleAdminMutation = useMutation<{ granted?: boolean; revoked?: boolean; userId: string }, Error, AdminUser>({\r\n    mutationFn: (user) =>\r\n      user.isAdmin ? apiClient.revokeAdmin(user.userId) : apiClient.grantAdmin(user.userId),\r\n    onMutate: (user) => {\r\n      setPendingToggles((prev) => new Set(prev).add(`admin-${user.userId}`));\r\n    },\r\n    onSettled: (_data, _err, user) => {\r\n      if (user) {\r\n        setPendingToggles((prev) => {\r\n          const next = new Set(prev);\r\n          next.delete(`admin-${user.userId}`);\r\n          return next;\r\n        });\r\n      }\r\n      queryClient.invalidateQueries({ queryKey: ['admin-users'] });\r\n    },\r\n    onError: (err) => {\r\n      setSnackbar({ open: true, message: `Admin toggle failed: ${err.message}`, severity: 'error' });\r\n    },\r\n  });\r\n\r\n  const toggleHangfireMutation = useMutation<{ granted?: boolean; revoked?: boolean; userId: string }, Error, AdminUser>({\r\n    mutationFn: (user) =>\r\n      user.hasHangfireAccess ? apiClient.revokeHangfire(user.userId) : apiClient.grantHangfire(user.userId),\r\n    onMutate: (user) => {\r\n      setPendingToggles((prev) => new Set(prev).add(`hangfire-${user.userId}`));\r\n    },\r\n    onSettled: (_data, _err, user) => {\r\n      if (user) {\r\n        setPendingToggles((prev) => {\r\n          const next = new Set(prev);\r\n          next.delete(`hangfire-${user.userId}`);\r\n          return next;\r\n        });\r\n      }\r\n      queryClient.invalidateQueries({ queryKey: ['admin-users'] });\r\n    },\r\n    onError: (err) => {\r\n      setSnackbar({ open: true, message: `Hangfire toggle failed: ${err.message}`, severity: 'error' });\r\n    },\r\n  });\r\n\r\n  const deleteMutation = useMutation({\r\n    mutationFn: (userId: string) => apiClient.deleteUser(userId),\r\n    onSuccess: () => {\r\n      setDeleteTarget(null);\r\n      setSnackbar({ open: true, message: 'Användare borttagen', severity: 'success' });\r\n      queryClient.invalidateQueries({ queryKey: ['admin-users'] });\r\n    },\r\n    onError: (err: Error) => {\r\n      setSnackbar({ open: true, message: `Kunde inte ta bort: ${err.message}`, severity: 'error' });\r\n    },\r\n  });\r\n\r\n  const handleLogin = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!password.trim()) return;\r\n    loginMutation.mutate(password);\r\n  };\r\n\r\n  if (statusQuery.isLoading) {\r\n    return (\r\n      <Container maxWidth=\"lg\" sx={{ py: 4, display: 'flex', justifyContent: 'center' }}>\r\n        <CircularProgress />\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  // Login form\r\n  if (!isAdmin) {\r\n    return (\r\n      <Container maxWidth=\"sm\" sx={{ py: 4 }}>\r\n        <Paper sx={{ p: 4 }}>\r\n          <Typography variant=\"h4\" gutterBottom>\r\n            Admin\r\n          </Typography>\r\n          <form onSubmit={handleLogin}>\r\n            <Stack spacing={2}>\r\n              <TextField\r\n                label=\"Lösenord\"\r\n                type=\"password\"\r\n                fullWidth\r\n                value={password}\r\n                onChange={(e) => setPassword(e.target.value)}\r\n                autoFocus\r\n              />\r\n              {loginError && <Alert severity=\"error\">{loginError}</Alert>}\r\n              <Button\r\n                type=\"submit\"\r\n                variant=\"contained\"\r\n                disabled={loginMutation.isPending || !password.trim()}\r\n                startIcon={loginMutation.isPending ? <CircularProgress size={18} /> : undefined}\r\n              >\r\n                Logga in\r\n              </Button>\r\n            </Stack>\r\n          </form>\r\n        </Paper>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  // Admin: User table\r\n  const users = usersQuery.data?.users ?? [];\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\r\n      <Typography variant=\"h4\" gutterBottom sx={{ fontSize: { xs: '1.5rem', md: '2rem' } }}>\r\n        Användare\r\n      </Typography>\r\n\r\n      {usersQuery.isLoading && (\r\n        <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\r\n          <CircularProgress />\r\n        </Box>\r\n      )}\r\n\r\n      {usersQuery.error && (\r\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n          Kunde inte hämta användare: {(usersQuery.error as Error).message}\r\n        </Alert>\r\n      )}\r\n\r\n      {usersQuery.data && (\r\n        <TableContainer component={Paper}>\r\n          <Table size=\"small\">\r\n            <TableHead>\r\n              <TableRow>\r\n                <TableCell>Användare</TableCell>\r\n                <TableCell>Zon</TableCell>\r\n                <TableCell>Inställningar</TableCell>\r\n                <TableCell>Daikin</TableCell>\r\n                <TableCell>Daikin Subject</TableCell>\r\n                <TableCell>Schema</TableCell>\r\n                <TableCell>Admin</TableCell>\r\n                <TableCell>Hangfire</TableCell>\r\n                <TableCell>Skapad</TableCell>\r\n                <TableCell>Åtgärd</TableCell>\r\n              </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n              {users.map((user) => (\r\n                <TableRow key={user.userId} sx={user.isCurrentUser ? { bgcolor: 'action.selected' } : undefined}>\r\n                  <TableCell>\r\n                    <Stack direction=\"row\" alignItems=\"center\" spacing={1}>\r\n                      <Tooltip title={user.userId}>\r\n                        <Typography variant=\"body2\" sx={{ fontFamily: 'monospace', cursor: 'pointer', userSelect: 'all' }}>\r\n                          {user.userId}\r\n                        </Typography>\r\n                      </Tooltip>\r\n                      {user.isCurrentUser && <Chip label=\"Du\" color=\"primary\" size=\"small\" />}\r\n                    </Stack>\r\n                  </TableCell>\r\n                  <TableCell>{user.zone || '—'}</TableCell>\r\n                  <TableCell>\r\n                    <Typography variant=\"body2\" noWrap>\r\n                      {user.settings.ComfortHours}h, {(user.settings.TurnOffPercentile * 100).toFixed(0)}%\r\n                    </Typography>\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {user.daikinAuthorized ? (\r\n                      <Tooltip title={user.daikinExpiresAtUtc ? `Utgår: ${user.daikinExpiresAtUtc}` : 'Auktoriserad'}>\r\n                        <CheckCircleIcon color=\"success\" fontSize=\"small\" />\r\n                      </Tooltip>\r\n                    ) : (\r\n                      <Tooltip title=\"Ej auktoriserad\">\r\n                        <CancelIcon color=\"error\" fontSize=\"small\" />\r\n                      </Tooltip>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {user.daikinSubject ? (\r\n                      <Tooltip title={user.daikinSubject}>\r\n                        <Typography variant=\"body2\" sx={{ fontFamily: 'monospace', cursor: 'pointer', userSelect: 'all', maxWidth: 120, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\r\n                          {user.daikinSubject}\r\n                        </Typography>\r\n                      </Tooltip>\r\n                    ) : (\r\n                      <Typography variant=\"body2\" color=\"text.secondary\">—</Typography>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {user.hasScheduleHistory ? (\r\n                      <Tooltip title={user.lastScheduleDate ? `Senast: ${user.lastScheduleDate}` : ''}>\r\n                        <Typography variant=\"body2\">{user.scheduleCount} st</Typography>\r\n                      </Tooltip>\r\n                    ) : (\r\n                      '—'\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {pendingToggles.has(`admin-${user.userId}`) ? (\r\n                      <CircularProgress size={20} />\r\n                    ) : (\r\n                      <Switch\r\n                        checked={user.isAdmin}\r\n                        disabled={user.isCurrentUser}\r\n                        onChange={() => toggleAdminMutation.mutate(user)}\r\n                        size=\"small\"\r\n                      />\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {pendingToggles.has(`hangfire-${user.userId}`) ? (\r\n                      <CircularProgress size={20} />\r\n                    ) : (\r\n                      <Switch\r\n                        checked={user.hasHangfireAccess}\r\n                        onChange={() => toggleHangfireMutation.mutate(user)}\r\n                        size=\"small\"\r\n                      />\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    {user.createdAt ? (\r\n                      <Tooltip title={`${new Date(user.createdAt).toISOString()}`}>\r\n                        <Typography variant=\"body2\">\r\n                          {new Date(user.createdAt).toLocaleString(undefined, {\r\n                            year: 'numeric',\r\n                            month: '2-digit',\r\n                            day: '2-digit',\r\n                            hour: '2-digit',\r\n                            minute: '2-digit',\r\n                          })}\r\n                        </Typography>\r\n                      </Tooltip>\r\n                    ) : (\r\n                      <Typography variant=\"body2\">—</Typography>\r\n                    )}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Tooltip title={user.isCurrentUser ? 'Kan inte ta bort dig själv' : 'Ta bort användare'}>\r\n                      <span>\r\n                        <IconButton\r\n                          size=\"small\"\r\n                          color=\"error\"\r\n                          disabled={user.isCurrentUser}\r\n                          onClick={() => setDeleteTarget(user)}\r\n                          aria-label={user.isCurrentUser ? 'Kan inte ta bort din egen användare' : `Ta bort användare ${user.userId.slice(0, 8)}`}\r\n                        >\r\n                          <DeleteIcon fontSize=\"small\" />\r\n                        </IconButton>\r\n                      </span>\r\n                    </Tooltip>\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n              {users.length === 0 && (\r\n                <TableRow>\r\n                  <TableCell colSpan={10} align=\"center\">\r\n                    <Typography variant=\"body2\" color=\"text.secondary\">Inga användare</Typography>\r\n                  </TableCell>\r\n                </TableRow>\r\n              )}\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n      )}\r\n\r\n      <Dialog open={deleteTarget !== null} onClose={() => setDeleteTarget(null)}>\r\n        <DialogTitle>Ta bort användare</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            Är du säker på att du vill ta bort användare{' '}\r\n            <strong>{deleteTarget?.userId?.slice(0, 8)}…</strong>?\r\n            {' '}All data (inställningar, tokens, schemahistorik) kommer att raderas permanent.\r\n          </DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setDeleteTarget(null)}>Avbryt</Button>\r\n          <Button\r\n            onClick={() => deleteTarget && deleteMutation.mutate(deleteTarget.userId)}\r\n            color=\"error\"\r\n            variant=\"contained\"\r\n            disabled={deleteMutation.isPending}\r\n            startIcon={deleteMutation.isPending ? <CircularProgress size={18} /> : <DeleteIcon />}\r\n          >\r\n            Ta bort\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Snackbar\r\n        open={snackbar.open}\r\n        autoHideDuration={4000}\r\n        onClose={() => setSnackbar((s: typeof snackbar) => ({ ...s, open: false }))}\r\n      >\r\n        <Alert severity={snackbar.severity} onClose={() => setSnackbar((s: typeof snackbar) => ({ ...s, open: false }))}>\r\n          {snackbar.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Container>\r\n  );\r\n}\r\n","import { Component, ReactNode, ErrorInfo } from 'react';\r\nimport { Container, Paper, Typography, Button, Stack } from '@mui/material';\r\nimport ErrorOutlineIcon from '@mui/icons-material/ErrorOutline';\r\n\r\ninterface Props {\r\n  children: ReactNode;\r\n}\r\n\r\ninterface State {\r\n  hasError: boolean;\r\n  error?: Error;\r\n}\r\n\r\nexport default class ErrorBoundary extends Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error): State {\r\n    return { hasError: true, error };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\r\n    console.error('ErrorBoundary caught error:', error, errorInfo);\r\n  }\r\n\r\n  handleReset = () => {\r\n    this.setState({ hasError: false, error: undefined });\r\n    window.location.href = '/';\r\n  };\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <Container maxWidth=\"sm\" sx={{ py: 8 }}>\r\n          <Paper sx={{ p: 4, textAlign: 'center' }}>\r\n            <Stack spacing={3} alignItems=\"center\">\r\n              <ErrorOutlineIcon color=\"error\" sx={{ fontSize: 64 }} />\r\n              <Typography variant=\"h4\">Something went wrong</Typography>\r\n              <Typography variant=\"body1\" color=\"text.secondary\">\r\n                {this.state.error?.message || 'An unexpected error occurred'}\r\n              </Typography>\r\n              <Button variant=\"contained\" onClick={this.handleReset}>\r\n                Return to Dashboard\r\n              </Button>\r\n            </Stack>\r\n          </Paper>\r\n        </Container>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n","import { BrowserRouter, Routes, Route } from 'react-router-dom';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport { ThemeProvider, CssBaseline } from '@mui/material';\r\nimport { theme } from './theme';\r\nimport Layout from './components/Layout';\r\nimport DashboardPage from './pages/DashboardPage';\r\nimport SettingsPage from './pages/SettingsPage';\r\nimport AdminPage from './pages/AdminPage';\r\nimport ErrorBoundary from './components/ErrorBoundary';\r\n\r\nconst queryClient = new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      refetchOnWindowFocus: false,\r\n      retry: 1,\r\n    },\r\n  },\r\n});\r\n\r\nfunction App() {\r\n  return (\r\n    <ErrorBoundary>\r\n      <QueryClientProvider client={queryClient}>\r\n        <ThemeProvider theme={theme}>\r\n          <CssBaseline />\r\n          <BrowserRouter key=\"router\">\r\n            <Layout>\r\n              <Routes>\r\n                <Route path=\"/\" element={<DashboardPage />} />\r\n                <Route path=\"/settings\" element={<SettingsPage />} />\r\n                <Route path=\"/admin\" element={<AdminPage />} />\r\n              </Routes>\r\n            </Layout>\r\n          </BrowserRouter>\r\n        </ThemeProvider>\r\n      </QueryClientProvider>\r\n    </ErrorBoundary>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App';\r\n\r\nReactDOM.createRoot(document.getElementById('root')!).render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>\r\n);\r\n"],"names":["m","require$$0","client","theme","createTheme","ApiClient","__publicField","source","params","zone","settings","embeddedId","payload","comfortTime","password","response","text","userId","url","body","json","apiClient","Layout","children","isAdmin","_a","useQuery","jsxs","Box","jsx","AppBar","Toolbar","Typography","Button","RouterLink","DashboardIcon","SettingsIcon","AdminPanelSettingsIcon","Container","useAuth","queryClient","useQueryClient","data","isLoading","error","refreshMutation","useMutation","revokeMutation","startAuth","AuthStatusChip","isAuthorized","expiresAt","CircularProgress","Chip","ErrorIcon","expiresAtDate","tooltipText","format","Tooltip","CheckCircleIcon","usePrices","PriceChart","Card","CardContent","Alert","allItems","a","b","xAxisData","p","todayData","tomorrowData","LineChart","value","GridContainer","styled","HourHeader","DayLabel","Cell","prop","state","isCurrentHour","ScheduleGrid","schedulePayload","Paper","now","currentHour","currentDay","scheduleId","schedule","actions","dayNames","todayName","tomorrowName","todayActions","todayStates","_","hour","timeKey","tomorrowActions","tomorrowStates","i","ScheduleLegend","Stack","CircleIcon","useScheduleHistory","ScheduleHistoryList","expanded","setExpanded","useState","handleChange","panel","isExpanded","entry","index","panelId","timestamp","Accordion","AccordionSummary","ExpandMoreIcon","AccordionDetails","JsonViewer","title","ConfirmDialog","open","message","confirmText","cancelText","onConfirm","onCancel","isDestructive","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","useSchedulePreview","useApplySchedule","useCurrentSchedule","useFlexibleState","enabled","query","useUserSettings","updateMutation","useManualComfort","DashboardPage","refresh","isRefreshing","schedulePreview","snackbar","setSnackbar","applyDialog","setApplyDialog","deviceIds","setDeviceIds","applySchedule","currentSchedule","isFlexible","flexibleState","manualComfort","formatDateTimeLocal","date","pad","n","manualComfortTime","setManualComfortTime","nextHour","handleManualComfort","comfortDate","result","handleGenerateSchedule","handleApplySchedule","confirmApplySchedule","handleRetrieveCurrentSchedule","TextField","e","Divider","Fragment","Snackbar","useZone","LoadingSkeleton","Skeleton","ZONES","SettingsPage","updateSettings","isUpdating","setZone","isZoneUpdating","revoke","formData","setFormData","revokeDialog","setRevokeDialog","useEffect","prev","handleSaveSettings","err","handleRevokeToken","Slider","FormControl","InputLabel","Select","z","MenuItem","FormControlLabel","Switch","AdminPage","setPassword","loginError","setLoginError","pendingToggles","setPendingToggles","deleteTarget","setDeleteTarget","statusQuery","usersQuery","loginMutation","pw","toggleAdminMutation","user","_data","_err","next","toggleHangfireMutation","deleteMutation","handleLogin","users","_b","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","CancelIcon","IconButton","DeleteIcon","_c","s","ErrorBoundary","Component","props","errorInfo","ErrorOutlineIcon","QueryClient","App","QueryClientProvider","ThemeProvider","CssBaseline","BrowserRouter","Routes","Route","ReactDOM","React"],"mappings":"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","x_google_ignoreList":[0]}